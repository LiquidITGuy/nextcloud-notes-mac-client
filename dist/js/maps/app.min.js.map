{"version":3,"sources":["app.js"],"names":["i18n","require","ipcRenderer","shell","remote","Store","store","dialog","$","removeMarkdown","EasyMDE","hljs","entities","AllHtmlEntities","log","fetch","dates","editor","modalWindow","sanitize","search","server","get","username","password","easymde","easymdeSetup","firstLoad","database","name","notes","fetchResult","call","id","body","set","apiCall","removeData","attr","favorite","resetEditor","html","exportNote","listNotes","displayNote","codemirror","setValue","value","insertTextAtCursor","text","note","getDoc","cursor","getCursor","replaceRange","wrapTextToSelection","start","end","selection","getSelection","replaceSelection","wrapBlockToCursor","line","setCursor","saveCategories","array","compressed","copy","slice","orderby","results","empty","addClass","i","length","theCount","w","a","Object","count","push","sort","x","y","itemX","itemY","item","theItem","theID","sanitizeCategory","showcount","catID","append","showHideCategoryIcons","hasClass","removeClass","sidebar","sortby","noteList","allCats","addSidebarEntry","category","getSelected","selectCategory","theDate","Date","modified","formattedDate","sidebarDate","getTime","catClass","theCat","t","plainTxt","content","replace","substr","title","titlebarDate","toTextArea","toggleSpellcheck","on","instance","event","which","doc","send","preview","clearHistory","togglePreview","setCheckLists","fadeIn","fadeOut","this","remove","check","appVersion","details","displayVersion","selected","parent","prev","children","editNote","isPreviewActive","focus","initCheckboxes","lineCount","historySize","undo","showMessageBoxSync","getCurrentWindow","message","detail","buttons","Math","floor","now","off","stopPropagation","preventDefault","toggleEditorCheckboxes","element","index","parents","getLineHandle","newvalue","ch","indexOf","execCommand","saveNote","deleteCheck","applyZoom","level","css","font-size","state","toggleCategories","toggleClass","capitalize","string","toLocaleUpperCase","language","catid","val","hide","show","searchResult","result","clean","window","onerror","error","url","info","__setTheme","cats","icons","openModal","__dirname","closeModal","data","select","toggleHeading1","toggleHeading2","toggleHeading3","toggleHeading4","toggleHeading5","toggleHeading6","toggleBold","toggleItalic","toggleStrikethrough","toggleUnorderedList","toggleOrderedList","drawLink","drawImage","toggleCodeBlock","toggleBlockquote","drawTable","drawHorizontalRule","zoom","parseInt","find","encoded","encode","decoded","decode","toLocaleLowerCase","document","openExternal","href","addEventListener","items","click","blur","prevAll","first","nextAll","link","bind","str","searchNotes","ready"],"mappings":"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","file":"../app.min.js","sourcesContent":["'use strict'\n\nconst i18n = require( './i18n.min' )\n\nconst { ipcRenderer, shell, remote } = require( 'electron' )\nconst Store\t\t\t\t= require( 'electron-store' )\nconst store\t\t\t\t= new Store()\nconst dialog\t\t\t= remote.dialog\nconst $\t\t\t\t\t= require( 'jquery' )\nconst removeMarkdown\t= require( 'remove-markdown' )\nconst EasyMDE\t\t\t= require( 'easymde' )\nconst hljs\t\t\t\t= require( 'highlight.js' )\nconst entities\t\t\t= require( 'html-entities' ).AllHtmlEntities\nconst log\t\t\t\t= require( 'electron-log' )\n\nconst fetch\t\t\t\t= require( './fetch.min' )\nconst dates\t\t\t\t= require( './dates.min' )\nconst editor\t\t\t= require( './editor.min' )\nconst modalWindow\t\t= require( './modal.min' )\nconst sanitize\t\t\t= require( './sanitize-category.min' )\nconst search\t\t\t= require( './search.min' )\n\nlet server \t\t= store.get( 'loginCredentials.server' ),\n\tusername \t= store.get( 'loginCredentials.username' ),\n\tpassword \t= store.get( 'loginCredentials.password' ),\n\teasymde \t= new EasyMDE( editor.easymdeSetup ),\n\tfirstLoad \t= true,\n\tdatabase \t= new Store({\n\t\t\t\t\tname: 'database',\n\t\t\t\t\tnotes: {}\n\t\t\t\t})\n\n\n\n//note(dgmid): log exceptions\n\nwindow.onerror = function( error, url, line ) {\n\t\n\tipcRenderer.send( 'error-in-render', {error, url, line} )\n}\n\n\n\nfunction fetchResult( call, id, body, notes ) {\n\t\n\tswitch( call ) {\n\t\t\t\n\t\tcase 'new': // create new note\n\t\t\t\n\t\t\tstore.set('appInterface.selected', notes.id)\n\t\t\tfetch.apiCall( 'all', null, null, function( call, id, body, notes ) {\n\t\t\t\t\n\t\t\t\tfetchResult( call, id, body, notes )\n\t\t\t})\n\t\t\t\n\t\tbreak\n\t\t\n\t\tcase 'save': // save note\n\t\t\t\n\t\t\tfetch.apiCall( 'sidebar', null, null, function( call, id, body, notes ) {\n\t\t\t\t\n\t\t\t\tfetchResult( call, id, body, notes )\n\t\t\t})\n\t\t\t\n\t\tbreak\n\t\t\n\t\tcase 'update': // modify existing note\n\t\t\t\n\t\t\t$(`button[data-id=\"${id}\"]`).removeData('favorite')\n\t\t\t$(`button[data-id=\"${id}\"]`).attr('data-favorite', body.favorite)\n\t\t\n\t\tbreak\n\t\t\n\t\tcase 'category':\n\t\t\n\t\t\tfetch.apiCall( 'sidebar', null, null, function( call, id, body, notes ) {\n\t\t\t\t\n\t\t\t\tfetchResult( call, id, body, notes )\n\t\t\t})\n\t\t\t\n\t\tbreak\n\t\t\n\t\tcase 'delete': // delete note\n\t\t\t\n\t\t\tlet selected = $('#sidebar li button.selected').attr('data-id')\n\t\t\t\n\t\t\tif( selected == id) {\n\t\t\t\t\n\t\t\t\tresetEditor()\n\t\t\t\t\n\t\t\t\tstore.set( 'appInterface.selected', null )\n\t\t\t\t$('#note').attr('data-id', null)\n\t\t\t\t$('#time, #note').html('')\n\t\t\t}\n\t\t\t\n\t\t\tfetch.apiCall( 'all', null, null, function( call, id, body, notes ) {\n\t\t\t\t\n\t\t\t\tfetchResult( call, id, body, notes )\n\t\t\t})\n\t\t\n\t\tbreak\n\t\t\n\t\tcase 'export':\n\t\t\t\n\t\t\tconst exportnote = require( './export.min' )\n\t\t\texportnote.exportNote( notes )\n\t\t\t\n\t\tbreak\n\t\t\n\t\tcase 'sidebar':\n\t\t\t\n\t\t\tlistNotes( notes, 'sidebar' )\n\t\t\t\n\t\tbreak\n\t\t\n\t\tdefault: // get single note or all notes\n\t\t\t\n\t\t\t(id) ? displayNote( notes ) : listNotes( notes )\n\t}\n}\n\n\n\n//note reset editor\n\nfunction resetEditor() {\n\t\n\teasymde.codemirror.setValue('')\n\teasymde.value('')\n\t$('.editor-preview').html('')\n}\n\n\n\n//note(dgmid): codeMirror - insert / wrap text\n\nfunction insertTextAtCursor( text ) {\n\t\n\tlet note = easymde.codemirror.getDoc()\n\tlet cursor = note.getCursor()\n\tnote.replaceRange(text, cursor)\n}\n\nfunction wrapTextToSelection( start, end ) {\n\t\n\tlet note = easymde.codemirror.getDoc()\n\tlet selection = note.getSelection()\n\tnote.replaceSelection( start + selection + end )\n}\n\nfunction wrapBlockToCursor( start, end ) {\n\t\n\tlet note = easymde.codemirror.getDoc()\n\tlet cursor = note.getCursor()\n\tnote.replaceRange(\n`${start}\n\n${end}`, cursor)\n\t\n\tcursor = note.getCursor()\n\tlet line = cursor.line -1\n\tnote.setCursor({ line: line })\n}\n\n\n\n//note(dgmid): build category list\n\nfunction saveCategories( array ) {\n\t\n\tlet compressed = [],\n\tcopy = array.slice(0),\n\torderby = store.get( 'appSettings.ordercats' ),\n\tresults = []\n\t\n\tif( orderby == null ) orderby = 'asc'\n\t\n\t$('#categories').empty().addClass( orderby )\n\t\n\tfor (var i = 0; i < array.length; i++) {\n\t\n\t\tvar theCount = 0\n\t\t\n\t\tfor (var w = 0; w < copy.length; w++) {\n\t\t\t\n\t\t\tif (array[i] == copy[w]) {\n\t\t\t\t\n\t\t\t\ttheCount++\n\t\t\t\tdelete copy[w]\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (theCount > 0) {\n\t\t\t\n\t\t\tvar a = new Object()\n\t\t\ta.value = array[i]\n\t\t\ta.count = theCount\n\t\t\tcompressed.push(a)\n\t\t}\n\t}\n\t\n\tif( compressed.length > 1 ) {\n\t\t\n\t\tcompressed.sort(function(x, y) {\n\t\t\t\n\t\t\tvar itemX = x['value']\n\t\t\tvar itemY = y['value']\n\t\t\t\n\t\t\treturn (itemX < itemY) ? -1 : (itemX > itemY) ? 1 : 0\n\t\t})\n\t}\n\t\n\tfor ( let item of compressed ) {\n\t\t\n\t\tlet theItem\t\t= item.value,\n\t\t\ttheCount\t= item.count,\n\t\t\ttheID \t\t= sanitize.sanitizeCategory( theItem ),\n\t\t\tshowcount\t= (store.get( 'appSettings.catcount' )) ? ' show' : ''\n\t\t\n\t\tif( theItem.length > 0 ) {\n\t\t\n\t\t\tresults.push( {\n\t\t\t\t\"item\": theItem ,\n\t\t\t\t\"catID\": theID,\n\t\t\t\t\"count\": theCount\n\t\t\t} )\n\t\t\t\n\t\t\t$('#categories').append(`<li><button class=\"custom\" data-catid=\"${theID}\" data-category=\"${theItem}\" title=\"${theItem}\"><span class=\"cat-name\">${theItem}</span><span class=\"cat-count${showcount}\">${theCount}</span></button></li>`)\n\t\t}\n\t}\n\t\n\t$(`.categories button[data-catid=\"${store.get('categories.selected')}\"]`).addClass( 'selected' )\n\t\n\tshowHideCategoryIcons()\n\tstore.set( 'categories.list', results )\n}\n\n\n\n//note(dgmid): hide category icons when a custom category is selected\n\nfunction showHideCategoryIcons() {\n\t\n\tif( $('.categories button.selected').hasClass( 'custom' ) ) {\n\t\t\n\t\t$('#sidebar').addClass( 'hidecats' )\n\t\t\n\t} else {\n\t\t\n\t\t$('#sidebar').removeClass( 'hidecats' )\n\t}\n}\n\n\n\n//note(dgmid): generate ordered sidebar entries\n\nfunction listNotes( array, sidebar ) {\n\t\n\tif( sidebar !== null ) database.set('notes', array)\n\t\n\tlet sortby \t= store.get( 'appSettings.sortby' ),\n\t\torderby = store.get( 'appSettings.orderby' ),\n\t\tnoteList = '',\n\t\tallCats = []\n\t\n\tif( array.length > 1 ) {\n\t\t\n\t\tarray.sort(function(x, y) {\n\t\t\t\n\t\t\tvar itemX = x[sortby]\n\t\t\tvar itemY = y[sortby]\n\t\t\t\n\t\t\tif( orderby === 'asc' ) {\n\t\t\t\t\n\t\t\t\treturn (itemX < itemY) ? -1 : (itemX > itemY) ? 1 : 0\n\t\t\t\n\t\t\t} else {\n\t\t\t\t\n\t\t\t\treturn (itemX > itemY) ? -1 : (itemX < itemY) ? 1 : 0\n\t\t\t}\n\t\t})\n\t}\n\t\n\tfor ( let item of array ) {\n\t\t\n\t\tnoteList += addSidebarEntry( item )\n\t\tallCats.push( item.category )\n\t}\n\t\n\t$('#sidebar').html( noteList )\n\t\n\tif( sidebar ) {\n\t\t\n\t\tgetSelected( 'sidebar' )\n\t\n\t} else {\n\t\t\n\t\tgetSelected()\n\t}\n\t\n\tsaveCategories( allCats )\n\tselectCategory( store.get('categories.selected') )\n}\n\n\n\n//note(dgmid): add sidebar entry\n\nfunction addSidebarEntry( item ) {\n\t\n\tlet theDate = new Date( item.modified ),\n\t\tformattedDate = dates.sidebarDate( theDate.getTime() )\n\t\n\tlet\tcatClass = ( item.category ) ? sanitize.sanitizeCategory( item.category ) : '##none##'\n\t\n\tlet\ttheCat = ( item.category ) ? item.category : i18n.t('app:categories.none', 'Uncategorised')\n\t\n\tlet plainTxt = removeMarkdown( item.content.replace(/(!\\[.*\\]\\(.*\\)|<[^>]*>|>|<)/g, ''))\n\t\n\tif( plainTxt ) {\n\n\t\tplainTxt = plainTxt.substr(0, 120).slice(item.title.length)\n\t\t\n\t} else {\n\t\t\n\t\tplainTxt = i18n.t('app:sidebar.notext', 'No additional text')\n\t}\n\t\n\tlet entry = `<li data-id=\"${item.id}\">\n\t\t\t\t\t<button data-id=\"${item.id}\" data-title=\"${item.title}\" data-content=\"\" data-catid=\"${catClass}\" data-category=\"${item.category}\" data-favorite=\"${item.favorite}\">\n\t\t\t\t\t\t<span class=\"side-title\">${item.title}</span>\n\t\t\t\t\t\t<span class=\"side-text\">${formattedDate}&nbsp;&nbsp;<span class=\"excerpt\">${plainTxt}</span></span>\n\t\t\t\t\t\t<span class=\"side-cat\">${theCat}</span>\n\t\t\t\t\t</button>\n\t\t\t\t</li>`\n\t\n\treturn entry\n}\n\n\n\n//note(dgmid): display single note\n\nfunction displayNote( note ) {\n\t\n\t$('#edit').removeClass('editing')\n\t\n\t$('#time').html( dates.titlebarDate( note.modified ) )\n\t\n\tif( easymde ) {\n\t\t\n\t\teasymde.toTextArea()\n\t\teasymde = null\n\t}\n\t\n\teasymde = new EasyMDE( editor.easymdeSetup )\n\t\n\ttoggleSpellcheck( store.get('appSettings.spellcheck') )\t\n\t\n\t// register right click for notes menu\n\t\n\teasymde.codemirror.on( 'mousedown', function( instance, event ) {\n\t\t\n\t\tif( event.which === 3 ) {\n\t\t\t\n\t\t\tlet selection = easymde.codemirror.doc.getSelection()\n\t\t\t\n\t\t\tipcRenderer.send('show-notes-menu',\n\t\t\t\t{\n\t\t\t\t\tselection: selection,\n\t\t\t\t\tpreview: false\n\t\t\t\t}\n\t\t\t)\n\t\t\treturn\n\t\t}\n\t})\n\t\n\t$('#note').attr('data-id', note.id)\n\teasymde.value( note.content )\n\teasymde.codemirror.clearHistory()\n\teasymde.togglePreview()\n\tsetCheckLists()\n\t\n\t$('time').fadeIn('fast')\n\t$('.loader').fadeOut(400, function() { $(this).remove() } )\n\t\n\tif( firstLoad === true ) {\n\t\t\n\t\tconst check = require( './version.min' )\t\t\n\t\tfirstLoad = 1\n\t\tcheck.appVersion( function( details ) {\n\t\t\t\n\t\t\tdisplayVersion( details )\n\t\t})\n\t}\n}\n\n\n\n//note(dgmid): display version status in titlebar\n\nfunction displayVersion( details ) {\n\t\n\t$('header').append( details )\n\t$('.fadein').fadeIn( 'slow' )\n}\n\n\n\n//note(dgmid): get selected note\n\nfunction getSelected( sidebar ) {\n\t\n\tlet selected = store.get( 'appInterface.selected' )\n\t\n\tif( selected ) {\n\t\t\n\t\t$(`button[data-id=\"${selected}\"]`).addClass('selected').parent().prev().children().addClass('above-selected')\n\t\t\n\t\tif( !sidebar ) {\n\t\t\t\n\t\t\tfetch.apiCall( 'single', selected, null, function( call, id, body, notes ) {\n\t\t\t\t\n\t\t\t\tfetchResult( call, id, body, notes )\n\t\t\t})\n\t\t}\n\t}\n}\n\n\n\n//note(dgmid): edit note\n\nfunction editNote() {\n\t\n\tlet selected = store.get( 'appInterface.selected' )\n\t\t\n\tif( selected ) {\n\t\t\n\t\tif( easymde.isPreviewActive() ) {\n\t\t\n\t\t\t$('#edit').attr('title', i18n.t('app:main.button.save', 'Save Note')).addClass('editing')\n\t\t\teasymde.togglePreview()\n\t\t\teasymde.codemirror.focus()\n\t\t\tinitCheckboxes()\n\t\t\teasymde.codemirror.on(\"changes\", initCheckboxes)\n\t\t\t\n\t\t\t\n\t\t\tif( store.get('appSettings.cursor') == 'end' ) {\n\t\t\t\t\n\t\t\t\teasymde.codemirror.setCursor(easymde.codemirror.lineCount(), 0)\n\t\t\t}\n\t\t\n\t\t} else {\n\t\t\t\n\t\t\tif( easymde.codemirror.historySize().undo > 0 ) {\n\t\t\t\n\t\t\t\tlet response = dialog.showMessageBoxSync(remote.getCurrentWindow(), {\n\t\t\t\t\t\t\t\tmessage: i18n.t('app:dialog.save.title', 'You have made changes to this note'),\n\t\t\t\t\t\t\t\tdetail: i18n.t('app:dialog.save.text', 'Do you want to save them?'),\n\t\t\t\t\t\t\t\tbuttons: [i18n.t('app:dialog.button.savechanges', 'Save changes'), i18n.t('app:dialog.button.cancel', 'Cancel')]\n\t\t\t\t\t\t\t})\n\t\t\t\t\n\t\t\t\tif( response === 0 ) {\n\t\t\t\t\t\n\t\t\t\t\tlet body = {\t\n\t\t\t\t\t\t\"content\": easymde.value(),\n\t\t\t\t\t\t\"modified\": Math.floor(Date.now() / 1000)\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\teasymde.codemirror.clearHistory()\n\t\t\t\t\t\n\t\t\t\t\tfetch.apiCall( 'save', selected, body, function( call, id, body, notes ) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tfetchResult( call, id, body, notes )\n\t\t\t\t\t})\n\t\t\t\t\t\n\t\t\t\t} else {\n\t\t\t\n\t\t\t\t\twhile ( easymde.codemirror.historySize().undo > 0) easymde.codemirror.undo()\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\teasymde.togglePreview()\n\t\t\t$('#edit').attr('title', i18n.t('app:main.button.edit', 'Edit Note')).removeClass('editing').focus()\n\t\t\tsetCheckLists()\n\t\t}\n\t}\n}\n\n\n\n//editor checkboxes - based on https://github.com/nextcloud/notes/issues/117\n//note(dgmid): init checkboxes\n\nfunction initCheckboxes() {\n\t\n\t$('.cm-formatting-task').off('click.toggleEditorCheckboxes').on('click.toggleEditorCheckboxes', function (event) {\n\t\t\n\t\t$('.cm-formatting-task').off('click.toggle_checkbox')\n\t\t\n\t\tevent.stopPropagation()\n\t\tevent.preventDefault()\n\t\ttoggleEditorCheckboxes( $(this) )\n\t})\n}\n\n\n\n//note(dgmid): toggle checkbox state\n\nfunction toggleEditorCheckboxes( element ) {\n\t\n\tlet doc \t= easymde.codemirror.getDoc(),\n\t\tindex \t= element.parents( '.CodeMirror-line' ).index(),\n\t\tline \t= doc.getLineHandle( index )\n\t\n\tlet newvalue = ( element.text() == '[x]' ) ? '[ ]' : '[x]'\n\t\n\tdoc.replaceRange(\n\t\tnewvalue,\n\t\t{\n\t\t\tline: index,\n\t\t\tch: line.text.indexOf( '[' )\n\t\t},\n\t\t{\n\t\t\tline: index,\n\t\t\tch: line.text.indexOf( ']' ) + 1\n\t\t}\n\t)\n\n\teasymde.codemirror.execCommand( 'goLineEnd' )\n}\n\n\n\n//note(dgmid): save note\n\nfunction saveNote( id ) {\n\t\n\tif(\t!easymde.isPreviewActive() && easymde.codemirror.historySize().undo > 0 ) {\n\t\t\n\t\tlet body = {\n\t\t\t\"content\": easymde.value(),\n\t\t\t\"modified\": Math.floor(Date.now() / 1000)\n\t\t}\n\t\t\t\t\t\n\t\teasymde.codemirror.clearHistory()\n\t\t\n\t\tfetch.apiCall( 'save', id, body, function( call, id, body, notes ) {\n\t\t\t\n\t\t\tfetchResult( call, id, body, notes )\n\t\t})\n\t\t\n\t\t\n\t}\n}\n\n\n\n//note(dgmid): delete check\n\nfunction deleteCheck( id ) {\n\t\n\tlet response = dialog.showMessageBoxSync(remote.getCurrentWindow(), {\n\t\t\t\t\t\t\tmessage: i18n.t('app:dialog.delete.title', 'Are you sure you want to delete this note?'),\n\t\t\t\t\t\t\tdetail: i18n.t('app:dialog.delete.text', 'This operation is not reversable.'),\n\t\t\t\t\t\t\tbuttons: [i18n.t('app:dialog.button.delete', 'Delete Note'), i18n.t('app:dialog.button.cancel', 'Cancel')]\n\t\t\t\t\t\t})\n\t\t\n\tif( response === 0 ) {\n\t\t\n\t\tfetch.apiCall( 'delete', id, null, function( call, id, body, notes ) {\n\t\t\t\n\t\t\tfetchResult( call, id, body, notes )\n\t\t})\n\t}\n}\n\n\n\n//note(dgmid): apply zoom level\n\nfunction applyZoom( level ) {\n\t\n\t$('.editor-preview').css({ \"font-size\": `${level/10}rem` })\n}\n\n\n\n//note(dgmid): toggle spellcheck\n\nfunction toggleSpellcheck( state ) {\n\t\n\t( state ) ? $('.CodeMirror').addClass('spellcheck') : $('.CodeMirror').removeClass('spellcheck')\n}\n\n\n\n//note(dgmid): show / hide categories\n\nfunction toggleCategories( state ) {\n\t\n\t$('#sidebar').toggleClass( 'showcats' )\n}\n\n\n\n//note(dgmid): set zoom slider\n\nipcRenderer.on('set-zoom-slider', (event, message) => {\n\t\n\tapplyZoom( message )\n})\n\n\n\n//note(dgmid): reload sidebar\n\nipcRenderer.on('reload-sidebar', (event, message) => {\n\t\n\tif( message === 'login' ) {\n\t\t\n\t\tserver \t\t= store.get( 'loginCredentials.server' ),\n\t\tusername \t= store.get( 'loginCredentials.username' ),\n\t\tpassword \t= store.get( 'loginCredentials.password' )\n\t\t\n\t\tlog.info( `${message} completed` )\n\t\t\n\t\tfetch.apiCall( 'all', null, null, function( call, id, body, notes ) {\n\t\t\t\n\t\t\tfetchResult( call, id, body, notes )\n\t\t})\n\t\n\t} else if( message === 'logout' ) {\n\t\t\n\t\tserver = username = password = null\n\t\t\n\t\tresetEditor()\n\t\t$('#sidebar, #categories').empty()\n\t\n\t} else {\n\t\t\n\t\tfetch.apiCall( 'sidebar', null, null, function( call, id, body, notes ) {\n\t\t\t\n\t\t\tfetchResult( call, id, body, notes )\n\t\t})\n\t}\n})\n\n\n\n//note(dgmid): spellcheck\n\nipcRenderer.on('spellcheck', (event, message) => {\n\t\n\tlet state = ( message ) ? false : true\n\t\n\tstore.set('appSettings.spellcheck', state)\n\ttoggleSpellcheck( state )\n})\n\n\n\n//note(dgmid): display categories\n\nipcRenderer.on('showcats', (event, message) => {\n\t\n\ttoggleCategories( message )\n})\n\n\n\n//note(dgmid): update-theme\n\nipcRenderer.on('set-theme', (event, message) => {\n\t\n\t__setTheme()\n})\n\n\n\n//note(dgmid): toggle-sidebar\n\nipcRenderer.on('toggle-categories', (event, message) => {\n\t\n\t$('#frame, footer').toggleClass('slide')\n\t\n\tlet cats = store.get( 'appInterface.categories' ) ? false : true\n\tstore.set( 'appInterface.categories', cats )\n})\n\n\n\n//note(dgmid): toggle category count\n\nipcRenderer.on('toggle-catcount', (event, message) => {\n\t\n\t$('.cat-count').toggleClass('show')\n\t\n\tlet count = store.get( 'appSettings.catcount' ) ? false : true\n\tstore.set( 'appSettings.catcount', count )\n})\n\n\n\n//note(dgmid): toggle category icons is sidebar\n\nipcRenderer.on('toggle-caticons', (event, message) => {\n\t\n\t$('#sidebar').toggleClass('showcats')\n\t\n\tlet icons = store.get( 'appSettings.showcats' ) ? false : true\n\tstore.set( 'appSettings.showcats', icons )\n})\n\n\n\n//note(dgmid): log in modal\n\nipcRenderer.on('open-login-modal', (event, message) => {\n\t\n\tmodalWindow.openModal( 'file://' + __dirname + '/../html/login.html', 480, 210, false )\n})\n\n\n\n//note(dgmid): close login modal\n\nipcRenderer.on('close-login-modal', (event, message) => {\n\t\n\tmodalWindow.closeModal\n})\n\n\n\n//note(dgmid): note menu commands\n\nipcRenderer.on('note', (event, message) => {\n\t\n\tlet selected = store.get( 'appInterface.selected' )\n\t\n\tswitch( message ) {\n\t\t\n\t\tcase 'new':\n\t\t\t\n\t\t\tlet body\n\t\t\t\n\t\t\tswitch( store.get( 'categories.selected' ) ) {\n\t\t\t\n\t\t\t\tcase '##all##':\n\t\t\t\tcase '##none##':\n\t\t\t\t\t\n\t\t\t\t\tbody = {\n\t\t\t\t\t\t\"content\": '# ' +  i18n.t('app:sidebar.new', 'New note')\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\tbreak\n\t\t\t\t\n\t\t\t\tcase '##fav##':\n\t\t\t\t\t\n\t\t\t\t\tbody = {\n\t\t\t\t\t\t\"content\": '# ' +  i18n.t('app:sidebar.new', 'New note'),\n\t\t\t\t\t\t\"favorite\": true\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\tbreak\n\t\t\t\t\n\t\t\t\tdefault:\n\t\t\t\t\t\n\t\t\t\t\tbody = {\n\t\t\t\t\t\t\"content\": '# ' +  i18n.t('app:sidebar.new', 'New note'),\n\t\t\t\t\t\t\"category\": $('.categories li button.selected').data('category')\n\t\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tfetch.apiCall( 'new', null, body, function( call, id, body, notes ) {\n\t\t\t\t\n\t\t\t\tfetchResult( call, id, body, notes )\n\t\t\t})\n\t\t\t\n\t\tbreak\n\t\t\n\t\tcase 'edit':\n\t\t\tif( selected ) editNote( selected )\n\t\tbreak\n\t\t\n\t\tcase 'save':\n\t\t\tif( selected ) saveNote( selected )\n\t\tbreak\n\t\t\n\t\tcase 'favorite':\n\t\t\tif( selected ) {\n\t\t\t\n\t\t\t\tlet favorite = ( $(`#sidebar li button[data-id=\"${selected}\"]`).attr('data-favorite') == 'true' ) ? false : true\n\t\t\t\t\n\t\t\t\tfetch.apiCall( 'update', selected, {\"favorite\": favorite}, function( call, id, body, notes ) {\n\t\t\t\t\t\n\t\t\t\t\tfetchResult( call, id, body, notes )\n\t\t\t\t})\n\t\t\t}\n\t\tbreak\n\t\t\n\t\tcase 'newcat':\n\t\t\t\n\t\t\tif( selected ) {\n\t\t\t\tmodalWindow.openModal( 'file://' + __dirname + `/../html/new-category.html?id=${selected}`, 480, 180, false )\n\t\t\t}\n\t\tbreak\n\t\t\n\t\tbreak\n\t\t\n\t\tcase 'export':\n\t\t\tif( selected ) {\n\t\t\t\t\n\t\t\t\tfetch.apiCall( 'export', selected, null, function( call, id, body, notes ) {\n\t\t\t\t\t\n\t\t\t\t\tfetchResult( call, id, body, notes )\n\t\t\t\t})\n\t\t\t}\n\t\tbreak\n\t\t\n\t\tcase 'delete':\n\t\t\tif( selected ) deleteCheck( selected )\n\t\tbreak\n\t\t\n\t\tcase 'selectall':\n\t\t\tif( !easymde.isPreviewActive() ) {\n\t\t\t\t\n\t\t\t\teasymde.codemirror.execCommand('selectAll')\n\t\t\t\n\t\t\t} else if( $('#search:focus') ) {\n\t\t\t\t\n\t\t\t\t$('#search').select()\n\t\t\t}\n\t\tbreak\n\t\t\n\t\tcase 'find':\n\t\t\tif( store.get( 'appInterface.categories' ) === false ) {\n\t\t\t\t\n\t\t\t\t$('#frame, footer').addClass('slide')\n\t\t\t\tstore.set( 'appInterface.categories', true )\n\t\t\t}\n\t\t\t\n\t\t\t$('#search').focus()\n\t\tbreak\n\t}\n})\n\n\n\n//note(dgmid): markdown menu commands\n\nipcRenderer.on('markdown', (event, message) => {\n\t\n\tif( !easymde.isPreviewActive() ) {\n\t\t\n\t\tswitch( message ) {\n\t\t\t\n\t\t\tcase 'h1':\n\t\t\t\teasymde.toggleHeading1()\n\t\t\tbreak\n\t\t\tcase 'h2':\n\t\t\t\teasymde.toggleHeading2()\n\t\t\tbreak\n\t\t\tcase 'h3':\n\t\t\t\teasymde.toggleHeading3()\n\t\t\tbreak\n\t\t\tcase 'h4':\n\t\t\t\teasymde.toggleHeading4()\n\t\t\tbreak\n\t\t\tcase 'h5':\n\t\t\t\teasymde.toggleHeading5()\n\t\t\tbreak\n\t\t\tcase 'h6':\n\t\t\t\teasymde.toggleHeading6()\n\t\t\tbreak\n\t\t\tcase 'b':\n\t\t\t\teasymde.toggleBold()\n\t\t\tbreak\n\t\t\tcase 'i':\n\t\t\t\teasymde.toggleItalic()\n\t\t\tbreak\n\t\t\tcase 'del':\n\t\t\t\teasymde.toggleStrikethrough()\n\t\t\tbreak\n\t\t\tcase 'ul':\n\t\t\t\teasymde.toggleUnorderedList()\n\t\t\tbreak\n\t\t\tcase 'ol':\n\t\t\t\teasymde.toggleOrderedList()\n\t\t\tbreak\n\t\t\tcase 'cl':\n\t\t\t\teasymde.codemirror.replaceSelection('- [ ]  ')\n\t\t\t\teasymde.codemirror.focus()\n\t\t\tbreak\n\t\t\tcase 'a':\n\t\t\t\teasymde.drawLink()\n\t\t\tbreak\n\t\t\tcase 'img':\n\t\t\t\teasymde.drawImage()\n\t\t\tbreak\n\t\t\tcase 'code':\n\t\t\t\teasymde.toggleCodeBlock()\n\t\t\tbreak\n\t\t\tcase 'blockquote':\n\t\t\t\teasymde.toggleBlockquote()\n\t\t\tbreak\n\t\t\tcase 'table':\n\t\t\t\teasymde.drawTable()\n\t\t\tbreak\n\t\t\tcase 'hr':\n\t\t\t\teasymde.drawHorizontalRule()\n\t\t\tbreak\n\t\t}\n\t}\n})\n\n\n\n//note(dgmid): html submenu menu commands\n\nipcRenderer.on('html', (event, message) => {\n\t\n\t\n\tif( !easymde.isPreviewActive() ) {\n\t\t\n\t\tswitch( message ) {\n\t\t\t\n\t\t\tcase 'small':\n\t\t\tcase 'sup':\n\t\t\tcase 'sub':\n\t\t\tcase 'u':\n\t\t\tcase 'mark':\n\t\t\t\twrapTextToSelection( `<${message}>`, `</${message}>` )\n\t\t\tbreak\n\t\t\tcase 'javascript':\n\t\t\tcase 'json':\n\t\t\tcase 'html':\n\t\t\tcase 'css':\n\t\t\tcase 'scss':\n\t\t\tcase 'php':\n\t\t\tcase 'objective-c':\n\t\t\tcase 'c-like':\n\t\t\tcase 'bash':\n\t\t\t\twrapBlockToCursor( `\\`\\`\\` ${message}`, `\\`\\`\\`` )\n\t\t\tbreak\n\t\t\tcase 'dl':\n\t\t\t\tinsertTextAtCursor(\n`<dl>\n\t<dt>${i18n.t('app:main.title', 'title')}</dt>\n\t<dd>${i18n.t('app:main.description', 'description')}</dd>\n\t<dt>${i18n.t('app:main.title', 'title')}</dt>\n\t<dd>${i18n.t('app:main.description', 'description')}</dd>\n</dl>` )\n\t\t\tbreak\n\t\t}\n\t}\n})\n\n\n\n//note(dgmid): view menu - zoom levels\n\nipcRenderer.on('set-zoom-level', (event, message) => {\n\t\n\tlet zoom = store.get( 'appSettings.zoom' )\n\t\n\tswitch( message ) {\n\t\t\n\t\tcase 1:\n\t\t\tzoom++\n\t\t\tif( zoom > 16 ) zoom = 16\n\t\tbreak\n\t\t\n\t\tcase -1:\n\t\t\tzoom--\n\t\t\tif( zoom < 4 ) zoom = 4\n\t\tbreak\n\t\t\n\t\tdefault:\n\t\t\tzoom = 10\n\t}\n\t\n\tstore.set( 'appSettings.zoom', zoom )\n\tapplyZoom( zoom )\n})\n\n\n\n//note(dgmid): sidebar context menu commands\n\nipcRenderer.on('context-favorite', (event, message) => {\n\t\n\tlet favorite \t= ( message.favorite == 'true' ) ? false : true,\n\t\tid \t\t\t= message.id\n\t\n\tfetch.apiCall( 'update', id, {\"favorite\": favorite}, function( call, id, body, notes ) {\n\t\t\t\n\t\tfetchResult( call, id, body, notes )\n\t})\n})\n\n\nipcRenderer.on('context-export', (event, id) => {\n\t\n\tfetch.apiCall( 'export', id, null, function( call, id, body, notes ) {\n\t\t\t\n\t\tfetchResult( call, id, body, notes )\n\t})\n})\n\n\nipcRenderer.on('context-delete', (event, id) => {\n\t\n\tdeleteCheck( id )\n})\n\n\nipcRenderer.on('context-category', (event, message) => {\n\t\n\tlet id \t\t\t= parseInt( message.id ),\n\t\tcategory\t= message.category,\n\t\tnotes\t\t= database.get('notes')\n\t\n\tlet note = notes.find( x => x.id === id ),\n\t\tbody = {\n\t\t\n\t\t\"modified\": \tnote.modified,\n\t\t\"content\": \t\tnote.content,\n\t\t\"category\":\t\tcategory\n\t}\n\t\n\tfetch.apiCall( 'category', id, body, function( call, id, body, notes ) {\n\t\t\t\n\t\tfetchResult( call, id, body, notes )\n\t})\n})\n\n\nipcRenderer.on('context-newcategory', (event, message) => {\n\t\n\tmodalWindow.openModal( 'file://' + __dirname + `/../html/new-category.html?id=${message}`, 480, 180, false )\n})\n\n\nipcRenderer.on('category-order', (event, message) => {\n\t\n\tstore.set( 'appSettings.ordercats', message )\n\t\n\t$('#categories').removeClass( 'asc desc' ).addClass( message )\n})\n\n\n//note(dgmid): notes context menu commands\n\nipcRenderer.on('context-note-encode', (event, message) => {\n\t\n\tlet encoded = entities.encode( message )\n\teasymde.codemirror.doc.replaceSelection( encoded )\n})\n\n\nipcRenderer.on('context-note-decode', (event, message) => {\n\t\n\tlet decoded = entities.decode( message )\n\teasymde.codemirror.doc.replaceSelection( decoded )\n})\n\n\nipcRenderer.on('context-note-upper', (event, message) => {\n\t\n\teasymde.codemirror.doc.replaceSelection(\n\t\tmessage.toLocaleUpperCase( i18n.language )\n\t)\n})\n\n\nipcRenderer.on('context-note-lower', (event, message) => {\n\t\n\teasymde.codemirror.doc.replaceSelection(\n\t\tmessage.toLocaleLowerCase( i18n.language )\n\t)\n})\n\n\nipcRenderer.on('context-note-caps', (event, message) => {\n\t\n\tlet selection = message.toLocaleLowerCase( i18n.language )\n\teasymde.codemirror.doc.replaceSelection(\n\t\tcapitalize( selection )\n\t)\n})\n\nfunction capitalize( string ) {\n\n    return string.replace(/(?:^|\\s)\\S/g,\n\t\tfunction(a) {\n\t\t\treturn a.toLocaleUpperCase( i18n.language )\n\t})\n}\n\n\n\n//note(dgmid): on click sidebar button\n\n$('body').on('click', '#sidebar li button', function(event) {\n\t\n\tevent.stopPropagation()\n\t\n\tlet id = $(this).data('id')\n\t\n\t$('#time').empty().hide()\n\t$('main').append('<div class=\"loader\"><div class=\"spinner\"></div></div>')\n\t\n\t$('#sidebar li button').removeClass('selected').removeClass('above-selected')\n\t$(this).addClass('selected').parent().prev().children().addClass('above-selected')\n\t\n\tfetch.apiCall( 'single', id, null, function( call, id, body, notes ) {\n\t\t\t\n\t\t\tfetchResult( call, id, body, notes )\n\t\t})\n\t\n\tstore.set( 'appInterface.selected', id )\n})\n\n\n\n//note(dgmid): on right click sidebar button\n\n$('body').on('mouseup', '#sidebar li button', function(event) {\n\t\n\tevent.stopPropagation()\n\t\n\tlet data = {\n\t\t'id': \t\t$(this).data('id'),\n\t\t'title': \t$(this).data('title'),\n\t\t'favorite': $(this).attr('data-favorite'),\n\t\t'category': $(this).attr('data-category'),\n\t\t'catID': \t$(this).attr('data-catid')\n\t}\n\t\n\tif( event.which === 3 ) {\n\t\t\n\t\tipcRenderer.send('show-sidebar-menu', data )\n\t\treturn\n\t}\n})\n\n\n$('body').on('focus', '#sidebar li button', function(event) {\n\t\n\t$(this).parent().prev().children().addClass('above-selected')\n})\n\n\n$('body').on('focusout', '#sidebar li button', function(event) {\n\t\n\tif( !$(this).hasClass('selected') ) {\n\t\t\n\t\t$(this).parent().prev().children().removeClass('above-selected')\n\t}\n})\n\n\n\n//note(dgmid): on click empty sidebar\n\n$('body').on('mouseup', 'aside', function(event) {\n\t\n\tif( event.which === 3 ) {\n\t\n\t\tipcRenderer.send('show-sidebar-menu', null )\n\t}\n})\n\n\n\n//note(dgmid): on click note preview\n\n$('body').on('mouseup', '.editor-preview-active', function(event) {\n\t\n\tif( event.which === 3 ) {\n\t\t\n\t\tipcRenderer.send('show-notes-menu',\n\t\t\t{\n\t\t\t\tselection: '',\n\t\t\t\tpreview: true\n\t\t\t}\n\t\t)\n\t}\n})\n\n\n\n//note(dgmid): open links in default browser\n\n$(document).on('click', 'a[href^=\"http\"]', function(event) {\n\t\n\tevent.preventDefault()\n\tshell.openExternal(this.href)\n})\n\n\n\n//note(dgmid): change category\n\n$('body').on('click', '.categories button', function(event) {\n\t\n\tlet cat = $(this).attr( 'data-category' ),\n\t\tcatid = $(this).attr( 'data-catid' )\n\t\n\t$('.categories button').removeClass('selected')\n\t$(this).addClass('selected')\n\t\n\tstore.set( 'categories.selected', catid )\n\t\n\tselectCategory( catid )\n\tshowHideCategoryIcons()\n})\n\n\n\n//note(dgmid): select category in category sidebar\n\nfunction selectCategory( catid ) {\n\t\n\t$('#search').val( '' )\n\t$('#clear').hide()\n\t$('#result').empty().hide()\n\t\n\tswitch( catid ) {\n\t\t\n\t\tcase '##all##':\n\t\t\t \n\t\t\t$(`#sidebar li`).show()\n\t\t\t\n\t\tbreak\n\t\t\n\t\tcase '##fav##':\n\t\t\t\n\t\t\t$(`#sidebar li`).hide()\n\t\t\t$(`#sidebar button[data-favorite='true']`).parent('li').show()\n\t\t\t\n\t\tbreak\n\t\t\n\t\tdefault:\n\t\t\t\n\t\t\t$(`#sidebar li`).hide()\n\t\t\t$(`#sidebar button[data-catid='${catid}']`).parent('li').show()\t\n\t\tbreak\n\t}\n}\n\n\n\n//note(dgmid): keyboard arrow and enter keys\n\ndocument.addEventListener( 'keydown', function( event ) {\n\t\n\tif( easymde.isPreviewActive() ) {\n\t\t\n\t\tlet items\n\t\t\n\t\tswitch( event.which ) {\n\t\t\t\n\t\t\tcase 13:\n\t\t\t\t$(':focus').click().focus()\n\t\t\tbreak\n\t\t\t\n\t\t\tcase 38:\n\t\t\t\t$('#sidebar button').blur()\n\t\t\t\titems = $('#sidebar button.selected').parent('li').prevAll('li:visible')\n\t\t\t\titems.first().find('button').click().focus()\n\t\t\tbreak\n\t\t\t\n\t\t\tcase 40:\n\t\t\t\t$('#sidebar button').blur()\n\t\t\t\titems = $('#sidebar button.selected').parent('li').nextAll('li:visible')\n\t\t\t\titems.first().find('button').click().focus()\n\t\t\tbreak\n\t\t}\n\t}\n})\n\n\n\n//note(dgmid): open update link in default browser\n\n$('body').on('click', '#update', (event) => {\n\t\n\tevent.preventDefault()\n\t\n\tlet link = $('#update').attr( 'data-url' )\n\t\n\tshell.openExternal(link)\n})\n\n\n\n//note(dgmid): remove bullets from checkbox lists\n\nfunction setCheckLists() {\n\t\n\t$('input[type=\"checkbox\"]').parent().css('list-style-type', 'none')\n}\n\n\n\n$('body').on('mouseenter', 'main a', function() {\n\t\n\t$('#location').empty().html( this.href )\n\t$('samp').addClass('show')\n})\n\n$('body').on('mouseleave', 'main a', function() {\n\t\n\t$('samp').removeClass('show')\n})\n\n\n\n//note(dgmid): search\n\n$('#search').bind( 'keyup', function() {\n\t\n\tlet str = $(this).val(),\n\t\tclear = $('#clear')\n\t\n\tlet state = ( str.length > 0 ) ? $('#clear').show() : $('#clear').hide()\n\t\n\tsearch.searchNotes( str, function( result, clean ) {\n\t\t\n\t\tsearchResult( result, clean )\n\t})\n})\n\n\nfunction searchResult( result, clean ) {\n\t\t\n\t$(`#sidebar li`).hide()\n\t$('#result').html( clean ).show()\n\t\n\tfor( let id of result ) {\n\t\t\n\t\t$(`#sidebar li[data-id='${id}']`).show()\t\n\t}\n}\n\n\n$('#clear').click(function() {\n\t\n\t$('#search').val('')\n\t$('#result').empty().hide()\n\tselectCategory( store.get( 'categories.selected' ) )\n\t$('.categories button.selected').focus()\n\t$(this).hide()\n})\n\n\n//note(dgmid): docready\n\n$(document).ready(function() {\n\t\n\t//note(dgmid): set lang\n\t\n\t$('html').attr('lang', i18n.language)\n\t\n\t\n\t//note(dgmid): display category icons in sidebar \n\t\n\tif( store.get( 'appSettings.showcats' ) ) {\n\t\t\n\t\t$('#sidebar').addClass( 'showcats' )\n\t}\n\t\n\t\n\t//note(dgmid): show or hide categories sidebar\n\t\n\tif( store.get( 'appInterface.categories' ) ) {\n\t\t\n\t\t$('#frame, footer').addClass( 'slide' )\n\t}\n\t\n\t\n\t//note(dgmid): show or hide category counts\n\t\n\tif( store.get( 'appSettings.catcount' ) ) {\n\t\t\n\t\t$('.cat-count').addClass('show')\n\t}\n\t\n\t\n\t//note(dgmid): set edit button title\n\t\n\t$('#edit').attr('title', i18n.t('app:main.button.edit', 'Edit Note'))\n\t\n\t\n\t//note(dgmid): set categories strings\n\t\n\t$('#cat-title').html( i18n.t('app:categories.title', 'Categories'))\n\t$('#cat-all').html( i18n.t('app:categories.all', 'All notes'))\n\t$('#cat-all').attr('title', i18n.t('app:categories.all', 'All notes'))\n\t$('#cat-fav').html( i18n.t('app:categories.fav', 'Favorites'))\n\t$('#cat-fav').attr('title', i18n.t('app:categories.fav', 'Favorites'))\n\t$('#cat-none').html( i18n.t('app:categories.none', 'Uncategorised'))\n\t$('#cat-none').attr('title', i18n.t('app:categories.none', 'Uncategorised'))\n\t$('#search').attr('placeholder', i18n.t('app:sidebar.search', 'Search'))\n\t\n\t\n\t//note(dgmid): check login\n\t\n\tif( !server || !username || !password ) {\n\t\t\n\t\tmodalWindow.openModal( 'file://' + __dirname + '/../html/login.html', 480, 210, false )\n\t\t\n\t} else {\n\t\t\n\t\tfetch.apiCall( 'all', null, null, function( call, id, body, notes ) {\n\t\t\t\n\t\t\tfetchResult( call, id, body, notes )\n\t\t})\n\t}\n\t\n\t\n\t//note(dgmid): edit save\n\t\n\t$('#edit').click(function() {\n\t\t\n\t\teditNote()\n\t})\n})\n"]}