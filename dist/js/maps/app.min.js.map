{"version":3,"sources":["app.js"],"names":["i18n","require","ipcRenderer","shell","remote","path","Store","store","dialog","dateFormat","$","marked","removeMarkdown","pretty","fs","server","get","username","password","modal","EasyMDE","easymdeSetup","element","autofocus","forceSync","status","spellChecker","toolbar","name","action","toggleHeadingSmaller","className","title","t","toggleBold","toggleItalic","toggleStrikethrough","toggleUnorderedList","toggleOrderedList","drawLink","drawImage","toggleCodeBlock","toggleBlockquote","drawTable","drawHorizontalRule","shortcuts","cleanBlock","toggleSideBySide","toggleFullScreen","togglePreview","easymde","apiCall","call","id","body","method","url","init","headers","Authorization","btoa","Content-Type","mode","cache","JSON","stringify","console","log","fetch","then","response","ok","text","showErrorBox","error","message","notes","parse","set","html","removeData","attr","favorite","resetEditor","exportNote","listNotes","displayNote","catch","codemirror","setValue","value","insertTextAtCursor","note","getDoc","cursor","getCursor","replaceRange","wrapTextToSelection","start","end","selection","getSelection","replaceSelection","array","sidebar","Date","sortby","orderby","length","sort","x","y","itemX","itemY","item","formattedDate","formatDate","modified","getTime","plainTxt","content","replace","substr","slice","append","category","getSelected","timestamp","today","yesterday","week","setHours","setDate","getDate","prep","date","time","addClass","removeClass","isPreviewActive","clearHistory","applyZoom","selected","parent","prev","children","editNote","focus","setCursor","lineCount","historySize","undo","showMessageBox","getCurrentWindow","detail","buttons","Math","floor","now","saveNote","exportPath","showSaveDialog","defaultPath","buttonLabel","properties","filters","extensions","filename","exported","filetype","split","pop","ocd","outputFile","readFile","data","Notification","err","deleteCheck","level","css","font-size","toggleSpellcheck","state","toggleCursorPosition","alert","openModal","width","height","resize","BrowserWindow","minWidth","maxWidth","minHeight","resizable","show","frame","transparent","webPreferences","devTools","preload","join","__dirname","nodeIntegration","loadURL","once","dayNames","monthNames","timeNames","on","event","__setTheme","toggleClass","cats","close","toggleHeading1","toggleHeading2","toggleHeading3","toggleHeading4","toggleHeading5","toggleHeading6","zoom","stopPropagation","this","which","send","hasClass","preventDefault","link","target","href","openExternal","document","ready","language","click"],"mappings":"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","file":"../app.min.js","sourcesContent":["'use strict'\n\nconst i18n = require( './i18n.min' )\n\nconst { ipcRenderer, shell, remote } = require( 'electron' )\n\nconst path\t\t\t\t= require('path')\nconst Store\t\t\t\t= require( 'electron-store' )\nconst store\t\t\t\t= new Store()\nconst dialog\t\t\t= remote.dialog\nconst dateFormat\t\t= require( 'dateformat' )\nconst $\t\t\t\t\t= require( 'jquery' )\nconst marked\t\t\t= require( 'marked' )\nconst removeMarkdown\t= require( 'remove-markdown' )\nconst pretty\t\t\t= require( 'pretty' )\nconst fs\t\t\t\t= require( 'fs-extra' )\n\nconst \tserver \t\t= store.get( 'loginCredentials.server' ),\n\t\tusername \t= store.get( 'loginCredentials.username' ),\n\t\tpassword \t= store.get( 'loginCredentials.password' )\n\nlet modal\n\nconst EasyMDE = require( 'easymde' )\n\nlet easymdeSetup = {\n\t\t\n\t\telement: $('#note')[0],\n\t\tautofocus: false,\n\t\tforceSync: true,\n\t\tstatus: false,\n\t\tspellChecker: true,\n\t\ttoolbar: [\t\n\t\t\t\t\t{\n\t\t\t\t\t\tname: \"Heading\",\n\t\t\t\t\t\taction: EasyMDE.toggleHeadingSmaller,\n\t\t\t\t\t\tclassName: \"fa fa-header\",\n\t\t\t\t\t\ttitle: i18n.t('app:toolbar.heading', 'Heading'),\n\t\t\t\t\t},\n\t\t\t\t\t'|',\n\t\t\t\t\t{\n\t\t\t\t\t\tname: \"bold\",\n\t\t\t\t\t\taction: EasyMDE.toggleBold,\n\t\t\t\t\t\tclassName: \"fa fa-bold\",\n\t\t\t\t\t\ttitle: i18n.t('app:toolbar.bold', 'Bold'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: \"italic\",\n\t\t\t\t\t\taction: EasyMDE.toggleItalic,\n\t\t\t\t\t\tclassName: \"fa fa-italic\",\n\t\t\t\t\t\ttitle: i18n.t('app:toolbar.italic', 'Italic'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: \"srtikethrough\",\n\t\t\t\t\t\taction: EasyMDE.toggleStrikethrough,\n\t\t\t\t\t\tclassName: \"fa fa-strikethrough\",\n\t\t\t\t\t\ttitle: i18n.t('app:toolbar.strikethrough', 'Strikethrough'),\n\t\t\t\t\t},\n\t\t\t\t\t'|',\n\t\t\t\t\t{\n\t\t\t\t\t\tname: \"unordered-list\",\n\t\t\t\t\t\taction: EasyMDE.toggleUnorderedList,\n\t\t\t\t\t\tclassName: \"fa fa-list-ul\",\n\t\t\t\t\t\ttitle: i18n.t('app:toolbar.ul', 'Generic List'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: \"ordered-list\",\n\t\t\t\t\t\taction: EasyMDE.toggleOrderedList,\n\t\t\t\t\t\tclassName: \"fa fa-list-ol\",\n\t\t\t\t\t\ttitle: i18n.t('app:toolbar.ol', 'Numbered List'),\n\t\t\t\t\t},\n\t\t\t\t\t'|',\n\t\t\t\t\t{\n\t\t\t\t\t\tname: \"link\",\n\t\t\t\t\t\taction: EasyMDE.drawLink,\n\t\t\t\t\t\tclassName: \"fa fa-link\",\n\t\t\t\t\t\ttitle: i18n.t('app:toolbar.link', 'Create Link'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: \"image\",\n\t\t\t\t\t\taction: EasyMDE.drawImage,\n\t\t\t\t\t\tclassName: \"fa fa-picture-o\",\n\t\t\t\t\t\ttitle: i18n.t('app:toolbar.image', 'Insert Image'),\n\t\t\t\t\t},\n\t\t\t\t\t'|',\n\t\t\t\t\t{\n\t\t\t\t\t\tname: \"code\",\n\t\t\t\t\t\taction: EasyMDE.toggleCodeBlock,\n\t\t\t\t\t\tclassName: \"fa fa-code\",\n\t\t\t\t\t\ttitle: i18n.t('app:toolbar.code', 'Code'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: \"quote\",\n\t\t\t\t\t\taction: EasyMDE.toggleBlockquote,\n\t\t\t\t\t\tclassName: \"fa fa-quote-left\",\n\t\t\t\t\t\ttitle: i18n.t('app:toolbar.quote', 'Quote'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: \"table\",\n\t\t\t\t\t\taction: EasyMDE.drawTable,\n\t\t\t\t\t\tclassName: \"fa fa-table\",\n\t\t\t\t\t\ttitle: i18n.t('app:toolbar.table', 'Insert Table'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: \"horizontal-rule\",\n\t\t\t\t\t\taction: EasyMDE.drawHorizontalRule,\n\t\t\t\t\t\tclassName: \"fa fa-minus\",\n\t\t\t\t\t\ttitle: i18n.t('app:toolbar.hr', 'Insert Horizontal Line'),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\tshortcuts: {\n\t\t\t'toggleStrikethrough': 'Cmd-Alt-D',\n\t\t\t'toggleBlockquote': 'Cmd-\\'',\n\t\t\t'drawTable': 'Cmd-T',\n\t\t\t'drawHorizontalRule': 'Cmd--',\n\t\t\t'cleanBlock': null,\n\t\t\t'toggleSideBySide': null,\n\t\t\t'toggleFullScreen': null,\n\t\t\t'togglePreview': null\t\n\t\t}\n\t}\n\nlet easymde = new EasyMDE( easymdeSetup )\n\n\n\n//note(@duncanmid): dateFormat i18n setup\n\ndateFormat.i18n = {\n\tdayNames: [\n\t\ti18n.t('date:sun', 'Sun'),\n\t\ti18n.t('date:mon', 'Mon'),\n\t\ti18n.t('date:tue', 'Tue'),\n\t\ti18n.t('date:wed', 'Wed'),\n\t\ti18n.t('date:thu', 'Thu'),\n\t\ti18n.t('date:fri', 'Fri'),\n\t\ti18n.t('date:sat', 'Sat'),\n\t\ti18n.t('date:sunday', 'Sunday'),\n\t\ti18n.t('date:monday', 'Monday'),\n\t\ti18n.t('date:tuesday', 'Tuesday'),\n\t\ti18n.t('date:wednesday', 'Wednesday'),\n\t\ti18n.t('date:thursday', 'Thursday'),\n\t\ti18n.t('date:friday', 'Friday'),\n\t\ti18n.t('date:saturday', 'Saturday')\n\t],\n\tmonthNames: [\n\t\ti18n.t('date:jan', 'Jan'),\n\t\ti18n.t('date:feb', 'Feb'),\n\t\ti18n.t('date:mar', 'Mar'),\n\t\ti18n.t('date:apr', 'Apr'),\n\t\ti18n.t('date:_may', 'May'),\n\t\ti18n.t('date:jun', 'Jun'),\n\t\ti18n.t('date:jul', 'Jul'),\n\t\ti18n.t('date:aug', 'Aug'),\n\t\ti18n.t('date:sep', 'Sep'),\n\t\ti18n.t('date:oct', 'Oct'),\n\t\ti18n.t('date:nov', 'Nov'),\n\t\ti18n.t('date:dec', 'Dec'),\n\t\ti18n.t('date:january', 'January'),\n\t\ti18n.t('date:february', 'February'),\n\t\ti18n.t('date:march', 'March'),\n\t\ti18n.t('date:april', 'April'),\n\t\ti18n.t('date:may', 'May'),\n\t\ti18n.t('date:june', 'June'),\n\t\ti18n.t('date:july', 'July'),\n\t\ti18n.t('date:august', 'August'),\n\t\ti18n.t('date:september', 'September'),\n\t\ti18n.t('date:october', 'October'),\n\t\ti18n.t('date:november', 'November'),\n\t\ti18n.t('date:december', 'December')\n\t],\n\ttimeNames: [\n\t\ti18n.t('date:a', 'a'),\n\t\ti18n.t('date:p', 'p'),\n\t\ti18n.t('date:am', 'am'),\n\t\ti18n.t('date:pm', 'pm'),\n\t\ti18n.t('date:_a', 'A'),\n\t\ti18n.t('date:_p', 'P'),\n\t\ti18n.t('date:_am', 'AM'),\n\t\ti18n.t('date:_pm', 'PM')\n\t]\n}\n\n\n\n//note(@duncanmid): call notes api\n\nfunction apiCall( call, id, body ) {\n\t\n\tlet method\n\t\n\tswitch( call ) {\n\t\t\n\t\tcase 'new':\n\t\t\tmethod = 'post'\n\t\tbreak\n\t\t\n\t\tcase 'save':\n\t\tcase 'update':\n\t\t\tmethod = 'put'\n\t\tbreak\n\t\t\n\t\tcase 'delete':\n\t\t\tmethod = 'delete'\n\t\tbreak\n\t\t\n\t\tdefault: //all, single or export\n\t\t\tmethod = 'get'\n\t}\n\t\n\tlet url = '/index.php/apps/notes/api/v0.2/notes',\n\tinit = {\n\t\t\n\t\tmethod: method,\n\t\theaders: {\n\t\t\t'Authorization': 'Basic ' + btoa( username + ':' + password ),\n\t\t\t'Content-Type': 'application/json',\n\t\t},\n\t\tmode: 'cors',\n\t\tcache: 'no-store'\n\t}\n\t\n\tif( id ) { url += `/${id}` }\n\tif( body ) { init.body = JSON.stringify( body ) }\n\t\n\tconsole.log( `URL: ${server}${url}` )\n\t\n\tfetch(server + url, init).then(function(response) {\n\t\n\t\tif (response.ok) {\n\t\t\t\n\t\t\tconsole.log('response OK')\n\t\t\treturn response.text()\n\t\t\n\t\t} else {\n\t\t\t\n\t\t\tdialog.showErrorBox(\n\t\t\t\ti18n.t('app:dialog.error.server.title', 'Server connection error'),\n\t\t\t\ti18n.t('app:dialog.error.server.text', 'there was an error connecting to') + `:\\n${server}`\n\t\t\t)\n\t\t\t\n\t\t\tconsole.log( response.error() )\n\t\t}\n\t\n\t}).then(function(message) {\n\t\t\n\t\t\n\t\tlet notes = JSON.parse(message)\n\t\t\n\t\t\n\t\tif (notes['status'] == 'error') {\n\t\t\t\n\t\t\tdialog.showErrorBox(\n\t\t\t\ti18n.t('app:dialog.error.json.title', 'JSON parsing error'),\n\t\t\t\ti18n.t('app:dialog.error.json.text', 'An error occured parsing the notes')\n\t\t\t)\n\t\t\t\n\t\t\tconsole.log(notes['message'])\t\n\t\t\n\t\t} else {\n\t\t\t\n\t\t\tswitch( call ) {\n\t\t\t\t\n\t\t\tcase 'new': // create new note\n\t\t\t\t\n\t\t\t\tstore.set('appInterface.selected', notes.id)\n\t\t\t\t$('#sidebar').html('')\n\t\t\t\tapiCall('all')\n\t\t\t\t\n\t\t\tbreak\n\t\t\t\n\t\t\tcase 'save': // save note\n\t\t\t\t\n\t\t\t\t$('#sidebar').html('')\n\t\t\t\tapiCall('sidebar')\n\t\t\t\t\n\t\t\tbreak\n\t\t\t\n\t\t\tcase 'update': // modify existing note\n\t\t\t\t\n\t\t\t\t$(`button[data-id=\"${id}\"]`).removeData('favorite')\n\t\t\t\t$(`button[data-id=\"${id}\"]`).attr('data-favorite', body.favorite)\n\t\t\t\n\t\t\tbreak\n\t\t\t\n\t\t\tcase 'delete': // delete note\n\t\t\t\t\n\t\t\t\tlet selected = $('#sidebar li button.selected').attr('data-id')\n\t\t\t\t\n\t\t\t\tif( selected == id) {\n\t\t\t\t\t\n\t\t\t\t\tresetEditor()\n\t\t\t\t\t\n\t\t\t\t\tstore.set( 'appInterface.selected', null )\n\t\t\t\t\t$('#note').attr('data-id', null)\n\t\t\t\t\t$('#time, #note').html('')\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t$('#sidebar').html('')\n\t\t\t\tapiCall('all')\n\t\t\t\n\t\t\tbreak\n\t\t\t\n\t\t\tcase 'export':\n\t\t\t\t\n\t\t\t\texportNote( notes )\n\t\t\t\t\n\t\t\tbreak\n\t\t\t\n\t\t\tcase 'sidebar':\n\t\t\t\t\n\t\t\t\tlistNotes( notes, 'sidebar' )\n\t\t\t\t\n\t\t\tbreak\n\t\t\t\n\t\t\tdefault: // get single note or all notes\n\t\t\t\t\n\t\t\t\t(id) ? displayNote( notes ) : listNotes( notes )\n\t\t\t}\n\t\t}\n\t\n\t}).catch(function(error) {\n\t\t\n\t\tdialog.showErrorBox(\n\t\t\ti18n.t('app:dialog.error.server.title', 'Server connection error'),\n\t\t\ti18n.t('app:dialog.error.server.text', 'there was an error connecting to') + `:\\n${server}`\n\t\t)\n\t\t\n\t\tconsole.log(error)\n\t})\n}\n\n\n\n//note reset editor\n\nfunction resetEditor() {\n\t\n\teasymde.codemirror.setValue('')\n\teasymde.value('')\n\t$('.editor-preview').html('')\n}\n\n\n\n//note(@duncanmid): codeMirror - insert / wrap text\n\nfunction insertTextAtCursor( text ) {\n\t\n\tlet note = easymde.codemirror.getDoc()\n\tlet cursor = note.getCursor()\n\tnote.replaceRange(text, cursor)\n}\n\nfunction wrapTextToSelection( start, end ) {\n\t\n\tlet note = easymde.codemirror.getDoc()\n\tlet selection = note.getSelection()\n\tnote.replaceSelection( start + selection + end )\n}\n\n\n\n//note(@duncanmid): generate ordered sidebar entries\n\nfunction listNotes( array, sidebar ) {\n\t\n\tconst date = new Date()\n\t\n\tlet sortby \t= store.get( 'appSettings.sortby' ),\n\t\torderby = store.get( 'appSettings.orderby' )\n\t\n\tif( array.length > 1 ) {\n\t\t\n\t\tarray.sort(function(x, y) {\n\t\t\t\n\t\t\tvar itemX = x[sortby]\n\t\t\tvar itemY = y[sortby]\n\t\t\t\n\t\t\tif( orderby === 'asc' ) {\n\t\t\t\t\n\t\t\t\treturn (itemX < itemY) ? -1 : (itemX > itemY) ? 1 : 0\n\t\t\t\n\t\t\t} else {\n\t\t\t\t\n\t\t\t\treturn (itemX > itemY) ? -1 : (itemX < itemY) ? 1 : 0\n\t\t\t}\n\t\t})\n\t}\n\t\n\tfor ( let item of array ) {\n\t\t\n\t\tlet theDate = new Date( item.modified )\n\t\tlet formattedDate = formatDate( theDate.getTime() )\n\t\t\n\t\tlet plainTxt = removeMarkdown( item.content.replace(/(!\\[.*\\]\\(.*\\)|<[^>]*>|>|<)/g, ''))\n\t\t\n\t\tif( plainTxt ) {\n\n\t\t\tplainTxt = plainTxt.substr(0, 120).slice(item.title.length)\n\t\t\t\n\t\t} else {\n\t\t\t\n\t\t\tplainTxt = i18n.t('app:sidebar.notext', 'No additional text')\n\t\t}\n\t\t                                                                                     \n\t\t$('#sidebar').append(\n\t\t`<li>\n\t\t\t<button data-id=\"${item.id}\" data-title=\"${item.title}\" data-category=\"${item.category}\" data-favorite=\"${item.favorite}\">\n\t\t\t\t<span class=\"side-title\">${item.title}</span>\n\t\t\t\t<span class=\"side-text\">${formattedDate}&nbsp;&nbsp;<span class=\"excerpt\">${plainTxt}</span></span>\n\t\t\t</button>\n\t\t</li>\n\t\t`)\n\t}\n\t\n\t( sidebar ) ? getSelected( 'sidebar' ) : getSelected()\n}\n\n\n\n//note(@duncanmid): formatDate\n\nfunction formatDate( timestamp ) {\n\t\n\tlet today\t\t= new Date(),\n\t\tyesterday\t= new Date(),\n\t\tweek\t\t= new Date()\n\t\n\ttoday.setHours( 0, 0, 0, 0 )\n\tyesterday.setHours( 0, 0, 0, 0 )\n\tyesterday.setDate( yesterday.getDate() - 1 )\n\tweek.setHours( 0, 0, 0, 0 )\n\tweek.setDate( week.getDate() - 7 )\n\t\n\t\n\tif( ( today.getTime() / 1000 ) < timestamp ) {\n\t\t\n\t\t//if today - show time\n\t\treturn dateFormat( timestamp * 1000, 'H:MM' )\n\t\n\t} else if ( ( yesterday.getTime() / 1000 ) < timestamp ) {\n\t\t\n\t\t//if yesterday - show string\n\t\treturn i18n.t('date:yesterday', 'yesterday')\n\t\n\t} else if ( ( week.getTime() / 1000 ) < timestamp ) {\n\t\t\n\t\t//if last week - show day\n\t\treturn dateFormat( timestamp * 1000, 'dddd' )\n\t\n\t} else {\n\t\t\n\t\t//else - show date\n\t\treturn dateFormat( timestamp * 1000, 'dd/mm/yy' )\n\t}\n}\n\n\n\n//note(@duncanmid): display single note\n\nfunction displayNote( note ) {\n\t\n\tlet prep = i18n.t('app:date.titlebar', 'at'),\n\t\tdate = dateFormat(note.modified * 1000, \"d mmmm, yyyy\"),\n\t\ttime = dateFormat(note.modified * 1000, \"HH:MM\")\n\t\n\t$('.CodeMirror-code').addClass('hide')\n\t$('#edit').removeClass('editing')\n\t\n\t$('#time').html( `${date} ${prep} ${time}` )\n\t\n\tresetEditor()\n\t\n\tif( easymde.isPreviewActive() ) easymde.togglePreview()\n\t\n\t$('#note').attr('data-id', note.id)\n\teasymde.value( note.content )\n\teasymde.codemirror.clearHistory()\n\teasymde.togglePreview()\n\tapplyZoom( store.get( 'appSettings.zoom' ) )\n\t\n\t$('.CodeMirror-code').removeClass('hide')\n}\n\n\n\n//note(@duncanmid): get selected note\n\nfunction getSelected( sidebar ) {\n\t\n\tlet selected = store.get( 'appInterface.selected' )\n\t\n\tif( selected ) {\n\t\t\n\t\t$(`button[data-id=\"${selected}\"]`).addClass('selected').parent().prev().children().addClass('above-selected')\n\t\t\n\t\tif( !sidebar ) apiCall( 'single', selected )\n\t}\n}\n\n\n\n//note(@duncanmid): edit note\n\nfunction editNote() {\n\t\n\tlet selected = store.get( 'appInterface.selected' )\n\t\t\n\tif( selected ) {\n\t\t\n\t\tif( easymde.isPreviewActive() ) {\n\t\t\n\t\t\t$('#edit').attr('title', i18n.t('app:main.button.save', 'Save Note')).addClass('editing')\n\t\t\teasymde.togglePreview()\n\t\t\teasymde.codemirror.focus()\n\t\t\t\n\t\t\tif( store.get('appSettings.cursor') == 'end' ) {\n\t\t\t\t\n\t\t\t\teasymde.codemirror.setCursor(easymde.codemirror.lineCount(), 0)\n\t\t\t}\n\t\t\n\t\t} else {\n\t\t\t\n\t\t\tif( easymde.codemirror.historySize().undo > 0 ) {\n\t\t\t\n\t\t\t\tlet response = dialog.showMessageBox(remote.getCurrentWindow(), {\n\t\t\t\t\t\t\t\tmessage: i18n.t('app:dialog.save.title', 'You have made changes to this note'),\n\t\t\t\t\t\t\t\tdetail: i18n.t('app:dialog.save.text', 'Do you want to save them?'),\n\t\t\t\t\t\t\t\tbuttons: [i18n.t('app:dialog.button.savechanges', 'Save changes'), i18n.t('app:dialog.button.cancel', 'Cancel')]\n\t\t\t\t\t\t\t})\n\t\t\t\t\n\t\t\t\tif( response === 0 ) {\n\t\t\t\t\t\n\t\t\t\t\tlet content = easymde.value()\n\t\t\t\t\t\n\t\t\t\t\teasymde.codemirror.clearHistory()\n\t\t\t\t\t\n\t\t\t\t\tapiCall( 'save', selected, {\"content\": content, \"modified\": Math.floor(Date.now() / 1000) } )\n\t\t\t\t\n\t\t\t\t} else {\n\t\t\t\n\t\t\t\t\twhile ( easymde.codemirror.historySize().undo > 0) easymde.codemirror.undo()\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\teasymde.togglePreview()\n\t\t\t$('#edit').attr('title', i18n.t('app:main.button.edit', 'Edit Note')).removeClass('editing').focus()\n\t\t}\n\t}\n}\n\n\n\n//note(@duncanmid): save note\n\nfunction saveNote( id ) {\n\t\n\t\tif(\t!easymde.isPreviewActive() &&\n\t\t\teasymde.codemirror.historySize().undo > 0 ) {\n\t\t\t\n\t\t\tconsole.log( 'SAVING!!' )\n\t\t\t\n\t\t\tlet content = easymde.value()\n\t\t\t\t\t\t\n\t\t\t//easymde.codemirror.clearHistory()\n\t\t\t\t\t\t\n\t\t\tapiCall( 'save', id, {\"content\": content, \"modified\": Math.floor(Date.now() / 1000) } )\n\t\t}\n}\n\n\n\n//note(@duncanmid): export note\n\nfunction exportNote( note ) {\n\t\n\tconst exportPath = store.get('exportPath')\n\t\n\tdialog.showSaveDialog(remote.getCurrentWindow(), {\n\t\t\t\n\t\t\tdefaultPath: `${exportPath}/${note.title}`,\n\t\t\tbuttonLabel: i18n.t('app:dialog.button.export', 'Export Note'),\n\t\t\tproperties: [\t'openDirectory',\n\t\t\t\t\t\t\t'createDirectory'\n\t\t\t\t\t\t],\n\t\t\tfilters: [\n\t\t\t\t{\tname:\t\ti18n.t('app:dialog.format.html', 'html'),\n\t\t\t\t\textensions:\t['html']\n\t\t\t\t},\n\t\t\t\t{\tname:\t\ti18n.t('app:dialog.format.md', 'markdown'),\n\t\t\t\t\textensions:\t['md']\n\t\t\t\t},\n\t\t\t\t{\tname:\t\ti18n.t('app:dialog.format.txt', 'text'),\n\t\t\t\t\textensions:\t['txt']\n\t\t\t\t}\n\t\t\t]\n\t\t},\t\t\n\t\t\n\t\trunExportProcess\n\t)\n\t\n\tfunction runExportProcess( filename ) {\n\t\t\n\t\tlet exported,\n\t\t\tfiletype\n\t\t\n\t\tswitch( filename.split('.').pop() ) {\n\t\t\t\n\t\t\tcase 'html':\n\t\t\t\t\n\t\t\t\tlet html = marked( note.content )\n\t\t\t\t\n\t\t\t\texported = pretty( `<!doctype html><html lang=\"en\"><head><meta charset=\"utf-8\" /><title>${note.title}</title></head><body>${html}</body></html>`, {ocd: true} )\n\t\t\t\t\n\t\t\t\tfiletype = 'html'\n\t\t\t\t\n\t\t\tbreak\n\t\t\t\n\t\t\tcase 'txt':\n\t\t\t\t\n\t\t\t\texported = removeMarkdown( note.content )\n\t\t\t\tfiletype = 'text'\n\t\t\t\n\t\t\tbreak\n\t\t\t\n\t\t\tdefault: //markdown\n\t\t\t\t\n\t\t\t\texported = note.content\n\t\t\t\tfiletype = 'markdown'\n\t\t}\n\t\t\n\t\tfs.outputFile(filename, exported)\n\t\t.then(() => fs.readFile(filename, 'utf8'))\n\t\t.then(data => {\n\t\t\t\n\t\t\tlet exportNotification = new Notification('Nextcloud Notes Client', {\n\t\t\t\t\n\t\t\t\tbody: i18n.t('app:notification.export.text', 'The note {{title}} has been exported as {{filetype}}', {title: note.title, filetype: filetype})\n\t\t\t})\n\t\t})\n\t\t\n\t\t.catch(err => {\n\t\t\t\n\t\t\tconsole.error(err)\n\t\t})\n\t}\n}\n\n\n\n//note(@duncanmid): delete check\n\nfunction deleteCheck( id ) {\n\t\n\tlet response = dialog.showMessageBox(remote.getCurrentWindow(), {\n\t\t\t\t\t\t\tmessage: i18n.t('app:dialog.delete.title', 'Are you sure you want to delete this note?'),\n\t\t\t\t\t\t\tdetail: i18n.t('app:dialog.delete.text', 'This operation is not reversable.'),\n\t\t\t\t\t\t\tbuttons: [i18n.t('app:dialog.button.delete', 'Delete Note'), i18n.t('app:dialog.button.cancel', 'Cancel')]\n\t\t\t\t\t\t})\n\t\t\n\tif( response === 0 ) {\n\t\t\n\t\tapiCall( 'delete', id )\n\t}\n}\n\n\n\n//note(@duncanmid): apply zoom level\n\nfunction applyZoom( level ) {\n\t\n\t$('.editor-preview').css({ \"font-size\": `${level/10}rem` })\n}\n\n\n\n//note(@duncanmid): toggle spellcheck\n\nfunction toggleSpellcheck( state ) {\n\t\n\t( state ) ? $('.CodeMirror').addClass('spellcheck') : $('.CodeMirror').removeClass('spellcheck')\n}\n\n\n\n//note(@duncanmid): toggle cursor position\n\nfunction toggleCursorPosition( state ) {\n\t\n\talert(state)\n}\n\n\n\n//note(@duncanmid): set zoom slider\n\nipcRenderer.on('set-zoom-slider', (event, message) => {\n\t\n\tapplyZoom( message )\n})\n\n\n\n//note(@duncanmid): reload sidebar\n\nipcRenderer.on('reload-sidebar', () => {\n\t\n\t$('#sidebar').html('')\n\tapiCall('all')\n})\n\n\n\n//note(@duncanmid): spellcheck\n\nipcRenderer.on('spellcheck', (event, message) => {\n\t\n\ttoggleSpellcheck( message )\n})\n\n\n\n//note(@duncanmid): update-theme\n\nipcRenderer.on('set-theme', (event, message) => {\n\t\n\t__setTheme()\n})\n\n\n\n//note(@duncanmid): toggle-sidebar\n\nipcRenderer.on('toggle-categories', (event, message) => {\n\t\n\t$('#frame, footer').toggleClass('slide')\n\t\n\tlet cats = store.get( 'appInterface.categories' ) ? false : true\n\tstore.set( 'appInterface.categories', cats )\n})\n\n\n//note(@duncanmid): modal\n\nfunction openModal( url, width, height, resize ) {\n\t\n\tmodal = new remote.BrowserWindow({\n\t\t\n\t\t\tparent: remote.getCurrentWindow(),\n\t\t\tmodal: true,\n\t\t\twidth: width,\n\t\t\tminWidth: width,\n\t\t\tmaxWidth: width,\n\t\t\theight: height,\n\t\t\tminHeight: height,\n\t\t\tresizable: resize,\n\t\t\tshow: false,\n\t\t\tframe: false,\n\t\t\ttransparent: true,\n\t\t\twebPreferences: {\n\t\t\t\tdevTools: false,\n\t\t\t\tpreload: path.join(__dirname, './preload.min.js'),\n\t\t\t\tnodeIntegration: true\n\t\t\t}\t\n\t\t})\n\t\t\n\tmodal.loadURL( url )\n\t\n\tmodal.once('ready-to-show', () => {\n\t\t\n\t\tmodal.show()\n\t})\n}\n\n\n\n//note(@duncanmid): log in modal\n\nipcRenderer.on('open-login-modal', (event, message) => {\n\t\n\topenModal( 'file://' + __dirname + '/../html/login.html', 480, 180, false )\n})\n\n\n\n//note(@duncanmid): close login modal\n\nipcRenderer.on('close-login-modal', (event, message) => {\n\t\n\tmodal.close()\n})\n\n\n\n//note(@duncanmid): note menu commands\n\nipcRenderer.on('note', (event, message) => {\n\t\n\tlet selected = store.get( 'appInterface.selected' )\n\t\n\tswitch( message ) {\n\t\t\n\t\tcase 'new':\n\t\t\tapiCall( 'new', null, {\"content\": '# ' +  i18n.t('app:sidebar.new', 'New note')} )\n\t\tbreak\n\t\t\n\t\tcase 'edit':\n\t\t\tif( selected ) editNote( selected )\n\t\tbreak\n\t\t\n\t\tcase 'save':\n\t\t\tif( selected ) saveNote( selected )\n\t\tbreak\n\t\t\n\t\tcase 'favorite':\n\t\t\tif( selected ) {\n\t\t\t\n\t\t\t\tlet favorite = ( $(`#sidebar li button[data-id=\"${selected}\"]`).attr('data-favorite') == 'true' ) ? false : true\n\t\t\t\n\t\t\t\tapiCall( 'update', selected, {\"favorite\": favorite} )\n\t\t\t}\n\t\tbreak\n\t\t\n\t\tcase 'export':\n\t\t\tif( selected ) apiCall( 'export', selected )\n\t\tbreak\n\t\t\n\t\tcase 'delete':\n\t\t\tif( selected ) deleteCheck( selected )\n\t\tbreak\n\t}\n})\n\n\n\n//note(@duncanmid): markdown menu commands\n\nipcRenderer.on('markdown', (event, message) => {\n\t\n\tif( !easymde.isPreviewActive() ) {\n\t\t\n\t\tswitch( message ) {\n\t\t\t\n\t\t\tcase 'h1':\n\t\t\t\teasymde.toggleHeading1()\n\t\t\tbreak\n\t\t\tcase 'h2':\n\t\t\t\teasymde.toggleHeading2()\n\t\t\tbreak\n\t\t\tcase 'h3':\n\t\t\t\teasymde.toggleHeading3()\n\t\t\tbreak\n\t\t\tcase 'h4':\n\t\t\t\teasymde.toggleHeading4()\n\t\t\tbreak\n\t\t\tcase 'h5':\n\t\t\t\teasymde.toggleHeading5()\n\t\t\tbreak\n\t\t\tcase 'h6':\n\t\t\t\teasymde.toggleHeading6()\n\t\t\tbreak\n\t\t\tcase 'b':\n\t\t\t\teasymde.toggleBold()\n\t\t\tbreak\n\t\t\tcase 'i':\n\t\t\t\teasymde.toggleItalic()\n\t\t\tbreak\n\t\t\tcase 'del':\n\t\t\t\teasymde.toggleStrikethrough()\n\t\t\tbreak\n\t\t\tcase 'ul':\n\t\t\t\teasymde.toggleUnorderedList()\n\t\t\tbreak\n\t\t\tcase 'ol':\n\t\t\t\teasymde.toggleOrderedList()\n\t\t\tbreak\n\t\t\tcase 'a':\n\t\t\t\teasymde.drawLink()\n\t\t\tbreak\n\t\t\tcase 'img':\n\t\t\t\teasymde.drawImage()\n\t\t\tbreak\n\t\t\tcase 'code':\n\t\t\t\teasymde.toggleCodeBlock()\n\t\t\tbreak\n\t\t\tcase 'blockquote':\n\t\t\t\teasymde.toggleBlockquote()\n\t\t\tbreak\n\t\t\tcase 'table':\n\t\t\t\teasymde.drawTable()\n\t\t\tbreak\n\t\t\tcase 'hr':\n\t\t\t\teasymde.drawHorizontalRule()\n\t\t\tbreak\n\t\t}\n\t}\n})\n\n\n\n//note(@duncanmid): html submenu menu commands\n\nipcRenderer.on('html', (event, message) => {\n\t\n\t\n\tif( !easymde.isPreviewActive() ) {\n\t\t\n\t\tswitch( message ) {\n\t\t\t\n\t\t\tcase 'small':\n\t\t\tcase 'sup':\n\t\t\tcase 'sub':\n\t\t\tcase 'u':\n\t\t\tcase 'mark':\n\t\t\t\twrapTextToSelection( `<${message}>`, `</${message}>` )\n\t\t\tbreak\n\t\t\tcase 'dl':\n\t\t\t\tinsertTextAtCursor(\n`<dl>\n\t<dt>${i18n.t('app:main.title', 'title')}</dt>\n\t<dd>${i18n.t('app:main.description', 'description')}</dd>\n\t<dt>${i18n.t('app:main.title', 'title')}</dt>\n\t<dd>${i18n.t('app:main.description', 'description')}</dd>\n</dl>` )\n\t\t\tbreak\n\t\t}\n\t}\n})\n\n\n\n//note(@duncanmid): view menu - zoom levels\n\nipcRenderer.on('set-zoom-level', (event, message) => {\n\t\n\tlet zoom = store.get( 'appSettings.zoom' )\n\t\n\tswitch( message ) {\n\t\t\n\t\tcase 1:\n\t\t\tzoom++\n\t\t\tif( zoom > 16 ) zoom = 16\n\t\tbreak\n\t\t\n\t\tcase -1:\n\t\t\tzoom--\n\t\t\tif( zoom < 4 ) zoom = 4\n\t\tbreak\n\t\t\n\t\tdefault:\n\t\t\tzoom = 10\n\t}\n\t\n\tstore.set( 'appSettings.zoom', zoom )\n\tapplyZoom( zoom )\n})\n\n\n\n//note(@duncanmid): context menu commanda\n\nipcRenderer.on('context-favorite', (event, message) => {\n\t\n\tlet favorite = ( message.favorite == 'true' ) ? false : true,\n\t\tid \t\t= message.id\n\t\n\tapiCall( 'update', id, {\"favorite\": favorite} )\n})\n\n\nipcRenderer.on('context-export', (event, id) => {\n\t\n\tapiCall( 'export', id )\n})\n\n\nipcRenderer.on('context-delete', (event, id) => {\n\t\n\tdeleteCheck( id )\n})\n\n\n\n//note(@duncanmid): on click sidebar button\n\n$('body').on('click', '#sidebar li button', function(event) {\n\t\n\tevent.stopPropagation()\n\t\n\tlet id = $(this).data('id')\n\t\n\t$('#time').html('')\n\t$('#note').html('<div class=\"loader\"></div>')\n\t\n\t$('#sidebar li button').removeClass('selected').removeClass('above-selected')\n\t$(this).addClass('selected').parent().prev().children().addClass('above-selected')\n\t\n\tapiCall( 'single', id )\n\t\n\tstore.set( 'appInterface.selected', id )\n})\n\n\n\n//note(@duncanmid): on right click sidebar button\n\n$('body').on('mouseup', '#sidebar li button', function(event) {\n\t\n\tevent.stopPropagation()\n\t\n\tlet data = {\n\t\t'id': $(this).data('id'),\n\t\t'title': $(this).data('title'),\n\t\t'favorite': $(this).attr('data-favorite')\n\t}\n\t\n\tif( event.which === 3 ) {\n\t\t\n\t\tipcRenderer.send('show-sidebar-menu', data )\n\t\treturn\n\t}\n})\n\n\n$('body').on('focus', '#sidebar li button', function(event) {\n\t\n\t$(this).parent().prev().children().addClass('above-selected')\n})\n\n\n$('body').on('focusout', '#sidebar li button', function(event) {\n\t\n\tif( !$(this).hasClass('selected') ) {\n\t\t\n\t\t$(this).parent().prev().children().removeClass('above-selected')\n\t}\n})\n\n\n\n//note(@duncanmid): on click empty sidebar\n\n$('body').on('mouseup', 'aside', function(event) {\n\t\n\tif( event.which === 3 ) {\n\t\n\t\tipcRenderer.send('show-sidebar-menu', null )\n\t}\n})\n\n\n\n//note(@duncanmid): open links in browser\n\n$('body').on('click', '.editor-preview a', (event) => {\n\t\n\tevent.preventDefault()\n\t\n\tlet link = event.target.href\n\t//todo(@duncanmid): scroll to #anchor links\n\tif( link.substr(0, 4) !== 'file' ) shell.openExternal(link)\n})\n\n\n\n//note(@duncanmid): docready\n\n$(document).ready(function() {\n\t\n\t// set lang\n\t$('html').attr('lang', i18n.language)\n\t\n\t// toggle categories sidebar\n\tif( store.get( 'appInterface.categories' ) ) {\n\t\t\n\t\t$('#frame, footer').addClass( 'slide' )\n\t}\n\t\n\t// set spellcheck\n\ttoggleSpellcheck( store.get('appSettings.spellcheck') )\n\t\n\t// set edit button title\n\t$('#edit').attr('title', i18n.t('app:main.button.edit', 'Edit Note'))\n\t\n\t// set categories srings\n\t$('#cat-title').html( i18n.t('app:categories.title', 'Categories') )\n\t$('#cat-all').html( i18n.t('app:categories.all', 'All notes') )\n\t$('#cat-none').html( i18n.t('app:categories.none', 'uncategorised') )\n\t\n\t// check login\n\tif( !server || !username || !password ) {\n\t\t\n\t\topenModal( 'file://' + __dirname + '/../html/login.html', 480, 180, false )\n\t\t\n\t} else {\n\t\t\n\t\tapiCall('all')\t\n\t}\n\t\n\t// edit save\n\t$('#edit').click(function() {\n\t\t\n\t\teditNote()\n\t})\n})\n"]}