{"version":3,"sources":["app.js"],"names":["i18n","require","ipcRenderer","shell","remote","version","app","getVersion","path","Store","store","dialog","dateFormat","$","marked","removeMarkdown","pretty","fs","EasyMDE","hljs","entities","AllHtmlEntities","compareVersions","log","easymde","modal","server","get","username","password","database","name","notes","easymdeSetup","element","autoDownloadFontAwesome","autofocus","forceSync","status","spellChecker","toolbar","action","toggleHeadingSmaller","className","title","t","toggleBold","toggleItalic","toggleStrikethrough","toggleUnorderedList","toggleOrderedList","drawLink","drawImage","toggleCodeBlock","toggleBlockquote","drawTable","drawHorizontalRule","shortcuts","cleanBlock","toggleSideBySide","toggleFullScreen","togglePreview","renderingConfig","codeSyntaxHighlighting","firstLoad","apiCall","call","id","body","method","url","init","headers","Authorization","btoa","Content-Type","mode","cache","credentials","JSON","stringify","info","fetch","then","response","ok","text","showErrorBox","error","message","parse","set","html","removeData","attr","favorite","resetEditor","exportNote","listNotes","displayNote","catch","codemirror","setValue","value","insertTextAtCursor","note","getDoc","cursor","getCursor","replaceRange","wrapTextToSelection","start","end","selection","getSelection","replaceSelection","wrapBlockToCursor","line","setCursor","saveCategories","array","empty","compressed","copy","slice","orderby","results","i","length","theCount","w","a","Object","count","push","sort","x","y","itemX","itemY","item","theItem","theID","replace","catID","append","addClass","showHideCategoryIcons","hasClass","removeClass","sidebar","Date","sortby","allCats","formattedDate","formatDate","modified","getTime","catClass","category","theCat","plainTxt","content","substr","getSelected","selectCategory","timestamp","today","yesterday","week","setHours","setDate","getDate","prep","date","time","toTextArea","toggleSpellcheck","on","instance","event","which","doc","send","preview","clearHistory","fadeIn","fadeOut","this","remove","checkAppVersion","selected","parent","prev","children","editNote","isPreviewActive","focus","lineCount","historySize","undo","showMessageBoxSync","getCurrentWindow","detail","buttons","Math","floor","now","saveNote","exportPath","showSaveDialog","defaultPath","buttonLabel","properties","filters","extensions","filename","exported","filetype","split","pop","language","ocd","outputFile","readFile","data","Notification","err","deleteCheck","applyZoom","level","css","font-size","state","toggleCategories","toggleClass","openModal","width","height","resize","BrowserWindow","minWidth","maxWidth","minHeight","resizable","show","frame","transparent","vibrancy","webPreferences","devTools","preload","join","__dirname","nodeIntegration","loadURL","once","catid","hide","getJSON","release","latest","compare","done","fail","jqXHR","textStatus","errorThrown","always","dayNames","monthNames","timeNames","window","onerror","__setTheme","cats","close","execCommand","toggleHeading1","toggleHeading2","toggleHeading3","toggleHeading4","toggleHeading5","toggleHeading6","zoom","parseInt","find","encoded","encode","decoded","decode","stopPropagation","preventDefault","link","target","href","openExternal","document","addEventListener","items","blur","prevAll","first","click","nextAll","ready"],"mappings":"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","file":"../app.min.js","sourcesContent":["'use strict'\n\nconst i18n = require( './i18n.min' )\n\nconst { ipcRenderer, shell, remote } = require( 'electron' )\nconst version \t\t\t= require('electron').remote.app.getVersion()\nconst path\t\t\t\t= require( 'path' )\nconst Store\t\t\t\t= require( 'electron-store' )\nconst store\t\t\t\t= new Store()\nconst dialog\t\t\t= remote.dialog\nconst dateFormat\t\t= require( 'dateformat' )\nconst $\t\t\t\t\t= require( 'jquery' )\nconst marked\t\t\t= require( 'marked' )\nconst removeMarkdown\t= require( 'remove-markdown' )\nconst pretty\t\t\t= require( 'pretty' )\nconst fs\t\t\t\t= require( 'fs-extra' )\nconst EasyMDE\t\t\t= require( 'easymde' )\nconst hljs\t\t\t\t= require( 'highlight.js' )\nconst entities\t\t\t= require( 'html-entities' ).AllHtmlEntities\nconst compareVersions\t= require('compare-versions')\nconst log\t\t\t\t= require( 'electron-log' )\n\nlet \tserver \t\t= store.get( 'loginCredentials.server' ),\n\t\tusername \t= store.get( 'loginCredentials.username' ),\n\t\tpassword \t= store.get( 'loginCredentials.password' )\n\nlet database = new Store({\n\tname: 'database',\n\tnotes: {}\n})\n\nlet easymdeSetup = {\n\t\t\n\t\telement: $('#note')[0],\n\t\tautoDownloadFontAwesome: false,\n\t\tautofocus: false,\n\t\tforceSync: true,\n\t\tstatus: false,\n\t\tspellChecker: true,\n\t\ttoolbar: [\t\n\t\t\t\t\t{\n\t\t\t\t\t\tname: \"Heading\",\n\t\t\t\t\t\taction: EasyMDE.toggleHeadingSmaller,\n\t\t\t\t\t\tclassName: \"icon-heading\",\n\t\t\t\t\t\ttitle: i18n.t('app:toolbar.heading', 'Heading'),\n\t\t\t\t\t},\n\t\t\t\t\t'|',\n\t\t\t\t\t{\n\t\t\t\t\t\tname: \"bold\",\n\t\t\t\t\t\taction: EasyMDE.toggleBold,\n\t\t\t\t\t\tclassName: \"icon-b\",\n\t\t\t\t\t\ttitle: i18n.t('app:toolbar.bold', 'Bold'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: \"italic\",\n\t\t\t\t\t\taction: EasyMDE.toggleItalic,\n\t\t\t\t\t\tclassName: \"icon-i\",\n\t\t\t\t\t\ttitle: i18n.t('app:toolbar.italic', 'Italic'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: \"srtikethrough\",\n\t\t\t\t\t\taction: EasyMDE.toggleStrikethrough,\n\t\t\t\t\t\tclassName: \"icon-del\",\n\t\t\t\t\t\ttitle: i18n.t('app:toolbar.strikethrough', 'Strikethrough'),\n\t\t\t\t\t},\n\t\t\t\t\t'|',\n\t\t\t\t\t{\n\t\t\t\t\t\tname: \"unordered-list\",\n\t\t\t\t\t\taction: EasyMDE.toggleUnorderedList,\n\t\t\t\t\t\tclassName: \"icon-ul\",\n\t\t\t\t\t\ttitle: i18n.t('app:toolbar.ul', 'Generic List'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: \"ordered-list\",\n\t\t\t\t\t\taction: EasyMDE.toggleOrderedList,\n\t\t\t\t\t\tclassName: \"icon-ol\",\n\t\t\t\t\t\ttitle: i18n.t('app:toolbar.ol', 'Numbered List'),\n\t\t\t\t\t},\n\t\t\t\t\t'|',\n\t\t\t\t\t{\n\t\t\t\t\t\tname: \"link\",\n\t\t\t\t\t\taction: EasyMDE.drawLink,\n\t\t\t\t\t\tclassName: \"icon-a\",\n\t\t\t\t\t\ttitle: i18n.t('app:toolbar.link', 'Create Link'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: \"image\",\n\t\t\t\t\t\taction: EasyMDE.drawImage,\n\t\t\t\t\t\tclassName: \"icon-img\",\n\t\t\t\t\t\ttitle: i18n.t('app:toolbar.image', 'Insert Image'),\n\t\t\t\t\t},\n\t\t\t\t\t'|',\n\t\t\t\t\t{\n\t\t\t\t\t\tname: \"code\",\n\t\t\t\t\t\taction: EasyMDE.toggleCodeBlock,\n\t\t\t\t\t\tclassName: \"icon-code\",\n\t\t\t\t\t\ttitle: i18n.t('app:toolbar.code', 'Code'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: \"quote\",\n\t\t\t\t\t\taction: EasyMDE.toggleBlockquote,\n\t\t\t\t\t\tclassName: \"icon-blockquote\",\n\t\t\t\t\t\ttitle: i18n.t('app:toolbar.quote', 'Quote'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: \"table\",\n\t\t\t\t\t\taction: EasyMDE.drawTable,\n\t\t\t\t\t\tclassName: \"icon-table\",\n\t\t\t\t\t\ttitle: i18n.t('app:toolbar.table', 'Insert Table'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: \"horizontal-rule\",\n\t\t\t\t\t\taction: EasyMDE.drawHorizontalRule,\n\t\t\t\t\t\tclassName: \"icon-hr\",\n\t\t\t\t\t\ttitle: i18n.t('app:toolbar.hr', 'Insert Horizontal Line'),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\tshortcuts: {\n\t\t\t'toggleStrikethrough': 'Shift-Cmd-D',\n\t\t\t'toggleBlockquote': 'Cmd-\\'',\n\t\t\t'drawTable': 'Cmd-T',\n\t\t\t'drawHorizontalRule': 'Cmd--',\n\t\t\t'cleanBlock': null,\n\t\t\t'toggleSideBySide': null,\n\t\t\t'toggleFullScreen': null,\n\t\t\t'togglePreview': null\t\n\t\t},\n\t\trenderingConfig: {\n\t\t\tcodeSyntaxHighlighting: true,\n\t\t\thljs: hljs\n\t\t}\n\t}\n\nlet easymde,\n\tmodal,\n\tfirstLoad = true\n\neasymde = new EasyMDE( easymdeSetup )\n\n\n//note(dgmid): dateFormat i18n setup\n\ndateFormat.i18n = {\n\tdayNames: [\n\t\ti18n.t('date:sun', 'Sun'),\n\t\ti18n.t('date:mon', 'Mon'),\n\t\ti18n.t('date:tue', 'Tue'),\n\t\ti18n.t('date:wed', 'Wed'),\n\t\ti18n.t('date:thu', 'Thu'),\n\t\ti18n.t('date:fri', 'Fri'),\n\t\ti18n.t('date:sat', 'Sat'),\n\t\ti18n.t('date:sunday', 'Sunday'),\n\t\ti18n.t('date:monday', 'Monday'),\n\t\ti18n.t('date:tuesday', 'Tuesday'),\n\t\ti18n.t('date:wednesday', 'Wednesday'),\n\t\ti18n.t('date:thursday', 'Thursday'),\n\t\ti18n.t('date:friday', 'Friday'),\n\t\ti18n.t('date:saturday', 'Saturday')\n\t],\n\tmonthNames: [\n\t\ti18n.t('date:jan', 'Jan'),\n\t\ti18n.t('date:feb', 'Feb'),\n\t\ti18n.t('date:mar', 'Mar'),\n\t\ti18n.t('date:apr', 'Apr'),\n\t\ti18n.t('date:_may', 'May'),\n\t\ti18n.t('date:jun', 'Jun'),\n\t\ti18n.t('date:jul', 'Jul'),\n\t\ti18n.t('date:aug', 'Aug'),\n\t\ti18n.t('date:sep', 'Sep'),\n\t\ti18n.t('date:oct', 'Oct'),\n\t\ti18n.t('date:nov', 'Nov'),\n\t\ti18n.t('date:dec', 'Dec'),\n\t\ti18n.t('date:january', 'January'),\n\t\ti18n.t('date:february', 'February'),\n\t\ti18n.t('date:march', 'March'),\n\t\ti18n.t('date:april', 'April'),\n\t\ti18n.t('date:may', 'May'),\n\t\ti18n.t('date:june', 'June'),\n\t\ti18n.t('date:july', 'July'),\n\t\ti18n.t('date:august', 'August'),\n\t\ti18n.t('date:september', 'September'),\n\t\ti18n.t('date:october', 'October'),\n\t\ti18n.t('date:november', 'November'),\n\t\ti18n.t('date:december', 'December')\n\t],\n\ttimeNames: [\n\t\ti18n.t('date:a', 'a'),\n\t\ti18n.t('date:p', 'p'),\n\t\ti18n.t('date:am', 'am'),\n\t\ti18n.t('date:pm', 'pm'),\n\t\ti18n.t('date:_a', 'A'),\n\t\ti18n.t('date:_p', 'P'),\n\t\ti18n.t('date:_am', 'AM'),\n\t\ti18n.t('date:_pm', 'PM')\n\t]\n}\n\n\n\n//note(dgmid): log exceptions\n\nwindow.onerror = function( error, url, line ) {\n\t\n\tipcRenderer.send( 'error-in-render', {error, url, line} )\n}\n\n\n\n//note(dgmid): call notes api\n\nfunction apiCall( call, id, body ) {\n\t\n\tlet method\n\t\n\tswitch( call ) {\n\t\t\n\t\tcase 'new':\n\t\t\tmethod = 'POST'\n\t\tbreak\n\t\t\n\t\tcase 'save':\n\t\tcase 'update':\n\t\tcase 'category':\n\t\t\tmethod = 'PUT'\n\t\tbreak\n\t\t\n\t\tcase 'delete':\n\t\t\tmethod = 'DELETE'\n\t\tbreak\n\t\t\n\t\tdefault: //all, single or export\n\t\t\tmethod = 'GET'\n\t}\n\t\n\tlet url = '/index.php/apps/notes/api/v0.2/notes',\n\tinit = {\n\t\t\n\t\tmethod: method,\n\t\theaders: {\n\t\t\t'Authorization': 'Basic ' + btoa( username + ':' + password ),\n\t\t\t'Content-Type': 'application/json',\n\t\t},\n\t\tmode: 'cors',\n\t\tcache: 'no-cache',\n\t\tcredentials: 'omit'\n\t}\n\t\n\tif( id ) { url += `/${id}` }\n\tif( body ) { init.body = JSON.stringify( body ) }\n\t\n\tlog.info( `URL: ${server}${url}` )\n\t\n\tfetch(server + url, init).then(function(response) {\n\t\n\t\tif (response.ok) {\n\t\t\t\n\t\t\tlog.info( 'response OK' )\n\t\t\treturn response.text()\n\t\t\n\t\t} else {\n\t\t\t\n\t\t\tdialog.showErrorBox(\n\t\t\t\ti18n.t('app:dialog.error.server.title', 'Server connection error'),\n\t\t\t\ti18n.t('app:dialog.error.server.text', 'there was an error connecting to') + `:\\n${server}`\n\t\t\t)\n\t\t\t\n\t\t\tlog.error( response.error() )\n\t\t}\n\t\n\t}).then(function(message) {\n\t\t\n\t\t\n\t\tlet notes = JSON.parse(message)\n\t\t\n\t\t\n\t\tif (notes['status'] == 'error') {\n\t\t\t\n\t\t\tdialog.showErrorBox(\n\t\t\t\ti18n.t('app:dialog.error.json.title', 'JSON parsing error'),\n\t\t\t\ti18n.t('app:dialog.error.json.text', 'An error occured parsing the notes')\n\t\t\t)\n\t\t\t\n\t\t\tlog.error( notes['message'] )\t\n\t\t\n\t\t} else {\n\t\t\t\n\t\t\tswitch( call ) {\n\t\t\t\t\n\t\t\tcase 'new': // create new note\n\t\t\t\t\n\t\t\t\tstore.set('appInterface.selected', notes.id)\n\t\t\t\t$('#sidebar').html('')\n\t\t\t\tapiCall('all')\n\t\t\t\t\n\t\t\tbreak\n\t\t\t\n\t\t\tcase 'save': // save note\n\t\t\t\t\n\t\t\t\t$('#sidebar').html('')\n\t\t\t\tapiCall('sidebar')\n\t\t\t\t\n\t\t\tbreak\n\t\t\t\n\t\t\tcase 'update': // modify existing note\n\t\t\t\t\n\t\t\t\t$(`button[data-id=\"${id}\"]`).removeData('favorite')\n\t\t\t\t$(`button[data-id=\"${id}\"]`).attr('data-favorite', body.favorite)\n\t\t\t\n\t\t\tbreak\n\t\t\t\n\t\t\tcase 'category':\n\t\t\t\n\t\t\t\t$('#sidebar').html('')\n\t\t\t\tapiCall('sidebar')\n\t\t\t\t\n\t\t\tbreak\n\t\t\t\n\t\t\tcase 'delete': // delete note\n\t\t\t\t\n\t\t\t\tlet selected = $('#sidebar li button.selected').attr('data-id')\n\t\t\t\t\n\t\t\t\tif( selected == id) {\n\t\t\t\t\t\n\t\t\t\t\tresetEditor()\n\t\t\t\t\t\n\t\t\t\t\tstore.set( 'appInterface.selected', null )\n\t\t\t\t\t$('#note').attr('data-id', null)\n\t\t\t\t\t$('#time, #note').html('')\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t$('#sidebar').html('')\n\t\t\t\tapiCall('all')\n\t\t\t\n\t\t\tbreak\n\t\t\t\n\t\t\tcase 'export':\n\t\t\t\t\n\t\t\t\texportNote( notes )\n\t\t\t\t\n\t\t\tbreak\n\t\t\t\n\t\t\tcase 'sidebar':\n\t\t\t\t\n\t\t\t\tlistNotes( notes, 'sidebar' )\n\t\t\t\t\n\t\t\tbreak\n\t\t\t\n\t\t\tdefault: // get single note or all notes\n\t\t\t\t\n\t\t\t\t(id) ? displayNote( notes ) : listNotes( notes )\n\t\t\t}\n\t\t}\n\t\n\t}).catch( function( error ) {\n\t\t\n\t\tdialog.showErrorBox(\n\t\t\ti18n.t('app:dialog.error.server.title', 'Server connection error'),\n\t\t\ti18n.t('app:dialog.error.server.text', 'there was an error connecting to') + `:\\n${server}`\n\t\t)\n\t\t\n\t\tlog.error( error )\n\t})\n}\n\n\n\n//note reset editor\n\nfunction resetEditor() {\n\t\n\teasymde.codemirror.setValue('')\n\teasymde.value('')\n\t$('.editor-preview').html('')\n}\n\n\n\n//note(dgmid): codeMirror - insert / wrap text\n\nfunction insertTextAtCursor( text ) {\n\t\n\tlet note = easymde.codemirror.getDoc()\n\tlet cursor = note.getCursor()\n\tnote.replaceRange(text, cursor)\n}\n\nfunction wrapTextToSelection( start, end ) {\n\t\n\tlet note = easymde.codemirror.getDoc()\n\tlet selection = note.getSelection()\n\tnote.replaceSelection( start + selection + end )\n}\n\nfunction wrapBlockToCursor( start, end ) {\n\t\n\tlet note = easymde.codemirror.getDoc()\n\tlet cursor = note.getCursor()\n\tnote.replaceRange(\n`${start}\n\n${end}`, cursor)\n\t\n\tcursor = note.getCursor()\n\tlet line = cursor.line -1\n\tnote.setCursor({ line: line })\n}\n\n\n\n//note(dgmid): build category list\n\nfunction saveCategories( array ) {\n\t\n\t$('#categories').empty()\n\t\n\tlet compressed = [],\n\tcopy = array.slice(0),\n\torderby = store.get( 'appSettings.ordercats' ),\n\tresults = []\n\t\n\tif( orderby == null ) orderby = 'asc'\n\t\n\tfor (var i = 0; i < array.length; i++) {\n\t\n\t\tvar theCount = 0\n\t\t\n\t\tfor (var w = 0; w < copy.length; w++) {\n\t\t\t\n\t\t\tif (array[i] == copy[w]) {\n\t\t\t\t\n\t\t\t\ttheCount++\n\t\t\t\tdelete copy[w]\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (theCount > 0) {\n\t\t\t\n\t\t\tvar a = new Object()\n\t\t\ta.value = array[i]\n\t\t\ta.count = theCount\n\t\t\tcompressed.push(a)\n\t\t}\n\t}\n\t\n\tif( compressed.length > 1 ) {\n\t\t\n\t\tcompressed.sort(function(x, y) {\n\t\t\t\n\t\t\tvar itemX = x['value']\n\t\t\tvar itemY = y['value']\n\t\t\t\n\t\t\tif( orderby === 'asc' ) {\n\t\t\t\t\n\t\t\t\treturn (itemX < itemY) ? -1 : (itemX > itemY) ? 1 : 0\n\t\t\t\n\t\t\t} else {\n\t\t\t\t\n\t\t\t\treturn (itemX > itemY) ? -1 : (itemX < itemY) ? 1 : 0\n\t\t\t}\n\t\t})\n\t}\n\t\n\tfor ( let item of compressed ) {\n\t\t\n\t\tlet theItem\t\t= item.value,\n\t\t\ttheID \t\t= theItem.replace(' ', '_')\n\t\t\n\t\tif( theItem.length > 0 ) {\n\t\t\n\t\t\tresults.push( { \"item\": theItem , \"catID\": theID } )\n\t\t\t\n\t\t\t$('#categories').append(`<li><button class=\"custom\" data-catid=\"${theID}\" data-category=\"${theItem}\" title=\"${theItem}\">${theItem}</button></li>`)\n\t\t}\n\t}\n\t\n\t$(`.categories button[data-catid=\"${store.get('categories.selected')}\"]`).addClass( 'selected' )\n\t\n\tshowHideCategoryIcons()\n\tstore.set( 'categories.list', results )\n}\n\n\n\n//note(dgmid): hide category icons when a custom category is selected\n\nfunction showHideCategoryIcons() {\n\t\n\tif( $('.categories button.selected').hasClass( 'custom' ) ) {\n\t\t\n\t\t$('#sidebar').addClass( 'hidecats' )\n\t\t\n\t} else {\n\t\t\n\t\t$('#sidebar').removeClass( 'hidecats' )\n\t}\n}\n\n\n\n//note(dgmid): generate ordered sidebar entries\n\nfunction listNotes( array, sidebar ) {\n\t\n\tif( sidebar !== null ) {\n\t\t\n\t\tdatabase.set('notes', array)\n\t}\n\t\n\tconst date = new Date()\n\t\n\tlet sortby \t= store.get( 'appSettings.sortby' ),\n\t\torderby = store.get( 'appSettings.orderby' ),\n\t\tallCats = []\n\t\n\tif( array.length > 1 ) {\n\t\t\n\t\tarray.sort(function(x, y) {\n\t\t\t\n\t\t\tvar itemX = x[sortby]\n\t\t\tvar itemY = y[sortby]\n\t\t\t\n\t\t\tif( orderby === 'asc' ) {\n\t\t\t\t\n\t\t\t\treturn (itemX < itemY) ? -1 : (itemX > itemY) ? 1 : 0\n\t\t\t\n\t\t\t} else {\n\t\t\t\t\n\t\t\t\treturn (itemX > itemY) ? -1 : (itemX < itemY) ? 1 : 0\n\t\t\t}\n\t\t})\n\t}\n\t\n\tfor ( let item of array ) {\n\t\t\n\t\tlet theDate = new Date( item.modified ),\n\t\t\tformattedDate = formatDate( theDate.getTime() )\n\t\t\n\t\tlet\tcatClass = ( item.category ) ? item.category.replace(' ', '_') : '##none##'\n\t\t\n\t\tlet\ttheCat = ( item.category ) ? item.category : i18n.t('app:categories.none', 'Uncategorised')\n\t\t\n\t\tlet plainTxt = removeMarkdown( item.content.replace(/(!\\[.*\\]\\(.*\\)|<[^>]*>|>|<)/g, ''))\n\t\t\n\t\tif( plainTxt ) {\n\n\t\t\tplainTxt = plainTxt.substr(0, 120).slice(item.title.length)\n\t\t\t\n\t\t} else {\n\t\t\t\n\t\t\tplainTxt = i18n.t('app:sidebar.notext', 'No additional text')\n\t\t}\n\t\t\n\t\t$('#sidebar').append(\n\t\t`<li>\n\t\t\t<button data-id=\"${item.id}\" data-title=\"${item.title}\" data-content=\"\" data-catid=\"${catClass}\" data-category=\"${item.category}\" data-favorite=\"${item.favorite}\">\n\t\t\t\t<span class=\"side-title\">${item.title}</span>\n\t\t\t\t<span class=\"side-text\">${formattedDate}&nbsp;&nbsp;<span class=\"excerpt\">${plainTxt}</span></span>\n\t\t\t\t<span class=\"side-cat\">${theCat}</span>\n\t\t\t</button>\n\t\t</li>\n\t\t`)\n\t\t\n\t\tallCats.push( item.category )\n\t}\n\t\n\t( sidebar ) ? getSelected( 'sidebar' ) : getSelected()\n\t\n\tsaveCategories( allCats )\n\tselectCategory( store.get('categories.selected') )\n}\n\n\n\n//note(dgmid): formatDate\n\nfunction formatDate( timestamp ) {\n\t\n\tlet today\t\t= new Date(),\n\t\tyesterday\t= new Date(),\n\t\tweek\t\t= new Date()\n\t\n\ttoday.setHours( 0, 0, 0, 0 )\n\tyesterday.setHours( 0, 0, 0, 0 )\n\tyesterday.setDate( yesterday.getDate() - 1 )\n\tweek.setHours( 0, 0, 0, 0 )\n\tweek.setDate( week.getDate() - 7 )\n\t\n\t\n\tif( ( today.getTime() / 1000 ) < timestamp ) {\n\t\t\n\t\t//if today - show time\n\t\treturn dateFormat( timestamp * 1000, 'H:MM' )\n\t\n\t} else if ( ( yesterday.getTime() / 1000 ) < timestamp ) {\n\t\t\n\t\t//if yesterday - show string\n\t\treturn i18n.t('date:yesterday', 'yesterday')\n\t\n\t} else if ( ( week.getTime() / 1000 ) < timestamp ) {\n\t\t\n\t\t//if last week - show day\n\t\treturn dateFormat( timestamp * 1000, 'dddd' )\n\t\n\t} else {\n\t\t\n\t\t//else - show date\n\t\treturn dateFormat( timestamp * 1000, 'dd/mm/yy' )\n\t}\n}\n\n\n\n//note(dgmid): display single note\n\nfunction displayNote( note ) {\n\t\n\tlet prep = i18n.t('app:date.titlebar', 'at'),\n\t\tdate = dateFormat(note.modified * 1000, \"d mmmm, yyyy\"),\n\t\ttime = dateFormat(note.modified * 1000, \"HH:MM\")\n\t\n\t$('#edit').removeClass('editing')\n\t\n\t$('#time').html( `${date} ${prep} ${time}` )\n\t\n\tif( easymde ) {\n\t\t\n\t\teasymde.toTextArea()\n\t\teasymde = null\n\t}\n\t\n\teasymde = new EasyMDE( easymdeSetup )\n\ttoggleSpellcheck( store.get('appSettings.spellcheck') )\t\n\t\n\t// register right click for notes menu\n\t\n\teasymde.codemirror.on( 'mousedown', function( instance, event ) {\n\t\t\n\t\tif( event.which === 3 ) {\n\t\t\t\n\t\t\tlet selection = easymde.codemirror.doc.getSelection()\n\t\t\t\n\t\t\tipcRenderer.send('show-notes-menu',\n\t\t\t\t{\n\t\t\t\t\tselection: selection,\n\t\t\t\t\tpreview: false\n\t\t\t\t}\n\t\t\t)\n\t\t\treturn\n\t\t}\n\t})\n\t\n\t$('#note').attr('data-id', note.id)\n\teasymde.value( note.content )\n\teasymde.codemirror.clearHistory()\n\teasymde.togglePreview()\n\t\n\t//applyZoom( store.get( 'appSettings.zoom' ) )\n\t\n\t$('time').fadeIn('fast')\n\t$('.loader').fadeOut(400, function() { $(this).remove() } )\n\t\n\tif( firstLoad === true ) {\n\t\t\n\t\tfirstLoad = 1\n\t\tcheckAppVersion()\n\t}\n}\n\n\n\n//note(dgmid): get selected note\n\nfunction getSelected( sidebar ) {\n\t\n\tlet selected = store.get( 'appInterface.selected' )\n\t\n\tif( selected ) {\n\t\t\n\t\t$(`button[data-id=\"${selected}\"]`).addClass('selected').parent().prev().children().addClass('above-selected')\n\t\t\n\t\tif( !sidebar ) apiCall( 'single', selected )\n\t}\n}\n\n\n\n//note(dgmid): edit note\n\nfunction editNote() {\n\t\n\tlet selected = store.get( 'appInterface.selected' )\n\t\t\n\tif( selected ) {\n\t\t\n\t\tif( easymde.isPreviewActive() ) {\n\t\t\n\t\t\t$('#edit').attr('title', i18n.t('app:main.button.save', 'Save Note')).addClass('editing')\n\t\t\teasymde.togglePreview()\n\t\t\teasymde.codemirror.focus()\n\t\t\t\n\t\t\t//todo delete this?\n\t\t\t//toggleSpellcheck( store.get('appSettings.spellcheck') )\n\t\t\t\n\t\t\tif( store.get('appSettings.cursor') == 'end' ) {\n\t\t\t\t\n\t\t\t\teasymde.codemirror.setCursor(easymde.codemirror.lineCount(), 0)\n\t\t\t}\n\t\t\n\t\t} else {\n\t\t\t\n\t\t\tif( easymde.codemirror.historySize().undo > 0 ) {\n\t\t\t\n\t\t\t\tlet response = dialog.showMessageBoxSync(remote.getCurrentWindow(), {\n\t\t\t\t\t\t\t\tmessage: i18n.t('app:dialog.save.title', 'You have made changes to this note'),\n\t\t\t\t\t\t\t\tdetail: i18n.t('app:dialog.save.text', 'Do you want to save them?'),\n\t\t\t\t\t\t\t\tbuttons: [i18n.t('app:dialog.button.savechanges', 'Save changes'), i18n.t('app:dialog.button.cancel', 'Cancel')]\n\t\t\t\t\t\t\t})\n\t\t\t\t\n\t\t\t\tif( response === 0 ) {\n\t\t\t\t\t\n\t\t\t\t\tlet content = easymde.value()\n\t\t\t\t\t\n\t\t\t\t\teasymde.codemirror.clearHistory()\n\t\t\t\t\t\n\t\t\t\t\tapiCall( 'save', selected, {\"content\": content, \"modified\": Math.floor(Date.now() / 1000) } )\n\t\t\t\t\t\n\t\t\t\t} else {\n\t\t\t\n\t\t\t\t\twhile ( easymde.codemirror.historySize().undo > 0) easymde.codemirror.undo()\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\teasymde.togglePreview()\n\t\t\t$('#edit').attr('title', i18n.t('app:main.button.edit', 'Edit Note')).removeClass('editing').focus()\n\t\t}\n\t}\n}\n\n\n\n//note(dgmid): save note\n\nfunction saveNote( id ) {\n\t\n\t\tif(\t!easymde.isPreviewActive() && easymde.codemirror.historySize().undo > 0 ) {\n\t\t\t\n\t\t\tlet content = easymde.value()\n\t\t\t\t\t\t\n\t\t\teasymde.codemirror.clearHistory()\n\t\t\t\t\t\t\n\t\t\tapiCall( 'save', id, {\"content\": content, \"modified\": Math.floor(Date.now() / 1000) } )\n\t\t}\n}\n\n\n\n//note(dgmid): export note\n\nfunction exportNote( note ) {\n\t\n\tconst exportPath = store.get('exportPath')\n\t\n\tdialog.showSaveDialog(remote.getCurrentWindow(), {\n\t\t\t\n\t\t\tdefaultPath: `${exportPath}/${note.title}`,\n\t\t\tbuttonLabel: i18n.t('app:dialog.button.export', 'Export Note'),\n\t\t\tproperties: [\t'openDirectory',\n\t\t\t\t\t\t\t'createDirectory'\n\t\t\t\t\t\t],\n\t\t\tfilters: [\n\t\t\t\t{\tname:\t\ti18n.t('app:dialog.format.html', 'html'),\n\t\t\t\t\textensions:\t['html']\n\t\t\t\t},\n\t\t\t\t{\tname:\t\ti18n.t('app:dialog.format.md', 'markdown'),\n\t\t\t\t\textensions:\t['md']\n\t\t\t\t},\n\t\t\t\t{\tname:\t\ti18n.t('app:dialog.format.txt', 'text'),\n\t\t\t\t\textensions:\t['txt']\n\t\t\t\t}\n\t\t\t]\n\t\t},\t\t\n\t\t\n\t\trunExportProcess\n\t)\n\t\n\tfunction runExportProcess( filename ) {\n\t\t\n\t\tlet exported,\n\t\t\tfiletype\n\t\t\n\t\tswitch( filename.split('.').pop() ) {\n\t\t\t\n\t\t\tcase 'html':\n\t\t\t\t\n\t\t\t\tlet html = marked( note.content )\n\t\t\t\t\n\t\t\t\texported = pretty( `<!doctype html><html lang=\"${i18n.language}\"><head><meta charset=\"utf-8\" /><title>${note.title}</title></head><body>${html}</body></html>`, {ocd: true} )\n\t\t\t\t\n\t\t\t\tfiletype = 'html'\n\t\t\t\t\n\t\t\tbreak\n\t\t\t\n\t\t\tcase 'txt':\n\t\t\t\t\n\t\t\t\texported = removeMarkdown( note.content )\n\t\t\t\tfiletype = 'text'\n\t\t\t\n\t\t\tbreak\n\t\t\t\n\t\t\tdefault: //markdown\n\t\t\t\t\n\t\t\t\texported = note.content\n\t\t\t\tfiletype = 'markdown'\n\t\t}\n\t\t\n\t\tfs.outputFile(filename, exported)\n\t\t.then(() => fs.readFile(filename, 'utf8'))\n\t\t.then(data => {\n\t\t\t\n\t\t\tlet exportNotification = new Notification('Nextcloud Notes Client', {\n\t\t\t\t\n\t\t\t\tbody: i18n.t('app:notification.export.text', 'The note {{title}} has been exported as {{filetype}}', {title: note.title, filetype: filetype})\n\t\t\t})\n\t\t})\n\t\t\n\t\t.catch(err => {\n\t\t\t\n\t\t\tlog.error( err )\n\t\t})\n\t}\n}\n\n\n\n//note(dgmid): delete check\n\nfunction deleteCheck( id ) {\n\t\n\tlet response = dialog.showMessageBoxSync(remote.getCurrentWindow(), {\n\t\t\t\t\t\t\tmessage: i18n.t('app:dialog.delete.title', 'Are you sure you want to delete this note?'),\n\t\t\t\t\t\t\tdetail: i18n.t('app:dialog.delete.text', 'This operation is not reversable.'),\n\t\t\t\t\t\t\tbuttons: [i18n.t('app:dialog.button.delete', 'Delete Note'), i18n.t('app:dialog.button.cancel', 'Cancel')]\n\t\t\t\t\t\t})\n\t\t\n\tif( response === 0 ) {\n\t\t\n\t\tapiCall( 'delete', id )\n\t}\n}\n\n\n\n//note(dgmid): apply zoom level\n\nfunction applyZoom( level ) {\n\t\n\t$('.editor-preview').css({ \"font-size\": `${level/10}rem` })\n}\n\n\n\n//note(dgmid): toggle spellcheck\n\nfunction toggleSpellcheck( state ) {\n\t\n\t( state ) ? $('.CodeMirror').addClass('spellcheck') : $('.CodeMirror').removeClass('spellcheck')\n}\n\n\n\n//note(dgmid): show / hide categories\n\nfunction toggleCategories( state ) {\n\t\n\t$('#sidebar').toggleClass( 'showcats' )\n}\n\n\n\n//note(dgmid): set zoom slider\n\nipcRenderer.on('set-zoom-slider', (event, message) => {\n\t\n\tapplyZoom( message )\n})\n\n\n\n//note(dgmid): reload sidebar\n\nipcRenderer.on('reload-sidebar', (event, message) => {\n\t\n\tif( message === 'login' || message === 'logout' ) {\n\t\n\t\tserver \t\t= store.get( 'loginCredentials.server' ),\n\t\tusername \t= store.get( 'loginCredentials.username' ),\n\t\tpassword \t= store.get( 'loginCredentials.password' )\n\t\n\t\tlog.info( `${message} completed` )\n\t}\n\t\n\t$('#sidebar').html('')\n\tapiCall('all')\n})\n\n\n\n//note(dgmid): spellcheck\n\nipcRenderer.on('spellcheck', (event, message) => {\n\t\n\tlog.info(`spellcheck prefs ${message}`)\n\t\n\ttoggleSpellcheck( message )\n})\n\n\n\n//note(dgmid): display categories\n\nipcRenderer.on('showcats', (event, message) => {\n\t\n\ttoggleCategories( message )\n})\n\n\n\n//note(dgmid): update-theme\n\nipcRenderer.on('set-theme', (event, message) => {\n\t\n\t__setTheme()\n})\n\n\n\n//note(dgmid): toggle-sidebar\n\nipcRenderer.on('toggle-categories', (event, message) => {\n\t\n\t$('#frame, footer').toggleClass('slide')\n\t\n\tlet cats = store.get( 'appInterface.categories' ) ? false : true\n\tstore.set( 'appInterface.categories', cats )\n})\n\n\n//note(dgmid): modal\n\nfunction openModal( url, width, height, resize ) {\n\t\n\tmodal = new remote.BrowserWindow({\n\t\t\n\t\t\tparent: remote.getCurrentWindow(),\n\t\t\tmodal: true,\n\t\t\twidth: width,\n\t\t\tminWidth: width,\n\t\t\tmaxWidth: width,\n\t\t\theight: height,\n\t\t\tminHeight: height,\n\t\t\tresizable: resize,\n\t\t\tshow: false,\n\t\t\tframe: false,\n\t\t\ttransparent: true,\n\t\t\tvibrancy: 'popover',\n\t\t\twebPreferences: {\n\t\t\tdevTools: true,\n\t\t\t\tpreload: path.join(__dirname, './preload.min.js'),\n\t\t\t\tnodeIntegration: true\n\t\t\t}\t\n\t\t})\n\t\t\n\tmodal.loadURL( url )\n\t\n\tmodal.once('ready-to-show', () => {\n\t\t\n\t\tmodal.show()\n\t})\n}\n\n\n\n//note(dgmid): log in modal\n\nipcRenderer.on('open-login-modal', (event, message) => {\n\t\n\topenModal( 'file://' + __dirname + '/../html/login.html', 480, 180, false )\n})\n\n\n\n//note(dgmid): close login modal\n\nipcRenderer.on('close-login-modal', (event, message) => {\n\t\n\tmodal.close()\n})\n\n\n\n//note(dgmid): note menu commands\n\nipcRenderer.on('note', (event, message) => {\n\t\n\tlet selected = store.get( 'appInterface.selected' )\n\t\n\tswitch( message ) {\n\t\t\n\t\tcase 'new':\n\t\t\t\n\t\t\tlet body\n\t\t\t\n\t\t\tswitch( store.get( 'categories.selected' ) ) {\n\t\t\t\n\t\t\t\tcase '##all##':\n\t\t\t\tcase '##none##':\n\t\t\t\t\t\n\t\t\t\t\tbody = {\n\t\t\t\t\t\t\"content\": '# ' +  i18n.t('app:sidebar.new', 'New note')\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\tbreak\n\t\t\t\t\n\t\t\t\tcase '##fav##':\n\t\t\t\t\t\n\t\t\t\t\tbody = {\n\t\t\t\t\t\t\"content\": '# ' +  i18n.t('app:sidebar.new', 'New note'),\n\t\t\t\t\t\t\"favorite\": true\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\tbreak\n\t\t\t\t\n\t\t\t\tdefault:\n\t\t\t\t\t\n\t\t\t\t\tbody = {\n\t\t\t\t\t\t\"content\": '# ' +  i18n.t('app:sidebar.new', 'New note'),\n\t\t\t\t\t\t\"category\": $('.categories li button.selected').data('category')\n\t\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tapiCall( 'new', null, body )\n\t\t\t\n\t\tbreak\n\t\t\n\t\tcase 'edit':\n\t\t\tif( selected ) editNote( selected )\n\t\tbreak\n\t\t\n\t\tcase 'save':\n\t\t\tif( selected ) saveNote( selected )\n\t\tbreak\n\t\t\n\t\tcase 'favorite':\n\t\t\tif( selected ) {\n\t\t\t\n\t\t\t\tlet favorite = ( $(`#sidebar li button[data-id=\"${selected}\"]`).attr('data-favorite') == 'true' ) ? false : true\n\t\t\t\n\t\t\t\tapiCall( 'update', selected, {\"favorite\": favorite} )\n\t\t\t}\n\t\tbreak\n\t\t\n\t\tcase 'newcat':\n\t\t\t\n\t\t\tif( selected ) {\n\t\t\t\topenModal( 'file://' + __dirname + `/../html/new-category.html?id=${selected}`, 480, 180, false )\n\t\t\t}\n\t\tbreak\n\t\t\n\t\tbreak\n\t\t\n\t\tcase 'export':\n\t\t\tif( selected ) apiCall( 'export', selected )\n\t\tbreak\n\t\t\n\t\tcase 'delete':\n\t\t\tif( selected ) deleteCheck( selected )\n\t\tbreak\n\t\t\n\t\tcase 'selectall':\n\t\t\tif( !easymde.isPreviewActive() ) easymde.codemirror.execCommand('selectAll')\n\t\tbreak\n\t}\n})\n\n\n\n//note(dgmid): markdown menu commands\n\nipcRenderer.on('markdown', (event, message) => {\n\t\n\tif( !easymde.isPreviewActive() ) {\n\t\t\n\t\tswitch( message ) {\n\t\t\t\n\t\t\tcase 'h1':\n\t\t\t\teasymde.toggleHeading1()\n\t\t\tbreak\n\t\t\tcase 'h2':\n\t\t\t\teasymde.toggleHeading2()\n\t\t\tbreak\n\t\t\tcase 'h3':\n\t\t\t\teasymde.toggleHeading3()\n\t\t\tbreak\n\t\t\tcase 'h4':\n\t\t\t\teasymde.toggleHeading4()\n\t\t\tbreak\n\t\t\tcase 'h5':\n\t\t\t\teasymde.toggleHeading5()\n\t\t\tbreak\n\t\t\tcase 'h6':\n\t\t\t\teasymde.toggleHeading6()\n\t\t\tbreak\n\t\t\tcase 'b':\n\t\t\t\teasymde.toggleBold()\n\t\t\tbreak\n\t\t\tcase 'i':\n\t\t\t\teasymde.toggleItalic()\n\t\t\tbreak\n\t\t\tcase 'del':\n\t\t\t\teasymde.toggleStrikethrough()\n\t\t\tbreak\n\t\t\tcase 'ul':\n\t\t\t\teasymde.toggleUnorderedList()\n\t\t\tbreak\n\t\t\tcase 'ol':\n\t\t\t\teasymde.toggleOrderedList()\n\t\t\tbreak\n\t\t\tcase 'a':\n\t\t\t\teasymde.drawLink()\n\t\t\tbreak\n\t\t\tcase 'img':\n\t\t\t\teasymde.drawImage()\n\t\t\tbreak\n\t\t\tcase 'code':\n\t\t\t\teasymde.toggleCodeBlock()\n\t\t\tbreak\n\t\t\tcase 'blockquote':\n\t\t\t\teasymde.toggleBlockquote()\n\t\t\tbreak\n\t\t\tcase 'table':\n\t\t\t\teasymde.drawTable()\n\t\t\tbreak\n\t\t\tcase 'hr':\n\t\t\t\teasymde.drawHorizontalRule()\n\t\t\tbreak\n\t\t}\n\t}\n})\n\n\n\n//note(dgmid): html submenu menu commands\n\nipcRenderer.on('html', (event, message) => {\n\t\n\t\n\tif( !easymde.isPreviewActive() ) {\n\t\t\n\t\tswitch( message ) {\n\t\t\t\n\t\t\tcase 'small':\n\t\t\tcase 'sup':\n\t\t\tcase 'sub':\n\t\t\tcase 'u':\n\t\t\tcase 'mark':\n\t\t\t\twrapTextToSelection( `<${message}>`, `</${message}>` )\n\t\t\tbreak\n\t\t\tcase 'javascript':\n\t\t\tcase 'json':\n\t\t\tcase 'html':\n\t\t\tcase 'css':\n\t\t\tcase 'scss':\n\t\t\tcase 'php':\n\t\t\tcase 'objective-c':\n\t\t\tcase 'c-like':\n\t\t\tcase 'bash':\n\t\t\t\twrapBlockToCursor( `\\`\\`\\` ${message}`, `\\`\\`\\`` )\n\t\t\tbreak\n\t\t\tcase 'dl':\n\t\t\t\tinsertTextAtCursor(\n`<dl>\n\t<dt>${i18n.t('app:main.title', 'title')}</dt>\n\t<dd>${i18n.t('app:main.description', 'description')}</dd>\n\t<dt>${i18n.t('app:main.title', 'title')}</dt>\n\t<dd>${i18n.t('app:main.description', 'description')}</dd>\n</dl>` )\n\t\t\tbreak\n\t\t}\n\t}\n})\n\n\n\n//note(dgmid): view menu - zoom levels\n\nipcRenderer.on('set-zoom-level', (event, message) => {\n\t\n\tlet zoom = store.get( 'appSettings.zoom' )\n\t\n\tswitch( message ) {\n\t\t\n\t\tcase 1:\n\t\t\tzoom++\n\t\t\tif( zoom > 16 ) zoom = 16\n\t\tbreak\n\t\t\n\t\tcase -1:\n\t\t\tzoom--\n\t\t\tif( zoom < 4 ) zoom = 4\n\t\tbreak\n\t\t\n\t\tdefault:\n\t\t\tzoom = 10\n\t}\n\t\n\tstore.set( 'appSettings.zoom', zoom )\n\tapplyZoom( zoom )\n})\n\n\n\n//note(dgmid): sidebar context menu commands\n\nipcRenderer.on('context-favorite', (event, message) => {\n\t\n\tlet favorite \t= ( message.favorite == 'true' ) ? false : true,\n\t\tid \t\t\t= message.id\n\t\n\tapiCall( 'update', id, {\"favorite\": favorite} )\n})\n\n\nipcRenderer.on('context-export', (event, id) => {\n\t\n\tapiCall( 'export', id )\n})\n\n\nipcRenderer.on('context-delete', (event, id) => {\n\t\n\tdeleteCheck( id )\n})\n\n\nipcRenderer.on('context-category', (event, message) => {\n\t\n\tlet id \t\t\t= parseInt( message.id ),\n\t\tcategory\t= message.category,\n\t\tnotes\t\t= database.get('notes')\n\t\n\tlet note = notes.find( x => x.id === id )\n\t\n\tapiCall( 'category', id, {\n\t\t\n\t\t\"modified\": \tnote.modified,\n\t\t\"content\": \t\tnote.content,\n\t\t\"category\":\t\tcategory\n\t})\n})\n\n\nipcRenderer.on('context-newcategory', (event, message) => {\n\t\n\topenModal( 'file://' + __dirname + `/../html/new-category.html?id=${message}`, 480, 180, false )\n})\n\n\n\n//note(dgmid): notes context menu commands\n\nipcRenderer.on('context-note-encode', (event, message) => {\n\t\n\tlet encoded = entities.encode( message )\n\teasymde.codemirror.doc.replaceSelection( encoded )\n})\n\n\nipcRenderer.on('context-note-decode', (event, message) => {\n\t\n\tlet decoded = entities.decode( message )\n\teasymde.codemirror.doc.replaceSelection( decoded )\n})\n\n\n\n//note(dgmid): on click sidebar button\n\n$('body').on('click', '#sidebar li button', function(event) {\n\t\n\tevent.stopPropagation()\n\t\n\tlet id = $(this).data('id')\n\t\n\t$('#time').html('').hide()\n\t$('main').append('<div class=\"loader\"><div class=\"spinner\"></div></div>')\n\t\n\t$('#sidebar li button').removeClass('selected').removeClass('above-selected')\n\t$(this).addClass('selected').parent().prev().children().addClass('above-selected')\n\t\n\tapiCall( 'single', id )\n\t\n\tstore.set( 'appInterface.selected', id )\n})\n\n\n\n//note(dgmid): on right click sidebar button\n\n$('body').on('mouseup', '#sidebar li button', function(event) {\n\t\n\tevent.stopPropagation()\n\t\n\tlet data = {\n\t\t'id': \t\t$(this).data('id'),\n\t\t'title': \t$(this).data('title'),\n\t\t'favorite': $(this).attr('data-favorite'),\n\t\t'category': $(this).attr('data-category'),\n\t\t'catID': \t$(this).attr('data-catid')\n\t}\n\t\n\tif( event.which === 3 ) {\n\t\t\n\t\tipcRenderer.send('show-sidebar-menu', data )\n\t\treturn\n\t}\n})\n\n\n$('body').on('focus', '#sidebar li button', function(event) {\n\t\n\t$(this).parent().prev().children().addClass('above-selected')\n})\n\n\n$('body').on('focusout', '#sidebar li button', function(event) {\n\t\n\tif( !$(this).hasClass('selected') ) {\n\t\t\n\t\t$(this).parent().prev().children().removeClass('above-selected')\n\t}\n})\n\n\n\n//note(dgmid): on click empty sidebar\n\n$('body').on('mouseup', 'aside', function(event) {\n\t\n\tif( event.which === 3 ) {\n\t\n\t\tipcRenderer.send('show-sidebar-menu', null )\n\t}\n})\n\n\n\n//note(dgmid): on click note preview\n\n$('body').on('mouseup', '.editor-preview-active', function(event) {\n\t\n\tif( event.which === 3 ) {\n\t\t\n\t\tipcRenderer.send('show-notes-menu',\n\t\t\t{\n\t\t\t\tselection: '',\n\t\t\t\tpreview: true\n\t\t\t}\n\t\t)\n\t}\n})\n\n\n\n//note(dgmid): open links in browser\n\n$('body').on('click', '.editor-preview a', (event) => {\n\t\n\tevent.preventDefault()\n\t\n\tlet link = event.target.href\n\tif( link.substr(0, 4) !== 'file' ) shell.openExternal(link)\n})\n\n\n\n//note(dgmid): change category\n\n$('body').on('click', '.categories button', function(event) {\n\t\n\tlet cat = $(this).attr( 'data-category' ),\n\t\tcatid = $(this).attr( 'data-catid' )\n\t\n\t$('.categories button').removeClass('selected')\n\t$(this).addClass('selected')\n\t\n\tstore.set( 'categories.selected', catid )\n\t\n\tselectCategory( catid )\n\tshowHideCategoryIcons()\n})\n\n\n\n//note(dgmid): select category in category sidebar\n\nfunction selectCategory( catid ) {\n\t\n\tswitch( catid ) {\n\t\t\n\t\tcase '##all##':\n\t\t\t \n\t\t\t$(`#sidebar li`).show()\n\t\t\t\n\t\tbreak\n\t\t\n\t\tcase '##fav##':\n\t\t\t\n\t\t\t$(`#sidebar li`).hide()\n\t\t\t$(`#sidebar button[data-favorite='true']`).parent('li').show()\n\t\t\t\n\t\tbreak\n\t\t\n\t\tdefault:\n\t\t\t\n\t\t\t$(`#sidebar li`).hide()\n\t\t\t$(`#sidebar button[data-catid='${catid}']`).parent('li').show()\t\n\t\tbreak\n\t}\n}\n\n\n\n//note(dgmid): keyboard arrow keys\n\ndocument.addEventListener( 'keydown', function( event ) {\n\t\n\tif( easymde.isPreviewActive() ) {\n\t\t\n\t\t$('#sidebar button').blur()\n\t\t\n\t\tlet items\n\t\t\n\t\tswitch( event.which ) {\n\t\t\t\n\t\t\tcase 38:\n\t\t\t\titems = $('#sidebar button.selected').parent('li').prevAll('li:visible')\n\t\t\t\titems.first().find('button').click()\n\t\t\tbreak\n\t\t\t\n\t\t\tcase 40:\n\t\t\t\titems = $('#sidebar button.selected').parent('li').nextAll('li:visible')\n\t\t\t\titems.first().find('button').click()\n\t\t\tbreak\n\t\t}\n\t}\n})\n\n\n\n//note(dgmid): open links in browser\n\n$('body').on('click', '#update', (event) => {\n\t\n\tevent.preventDefault()\n\t\n\tlet link = $('#update').attr( 'data-url' )\n\t\n\tshell.openExternal(link)\n})\n\n\n\n//note(dgmid): check app version\n\nfunction checkAppVersion() {\n\t\t\n\t$.getJSON( 'https://api.github.com/repos/dgmid/nextcloud-notes-mac-client/releases/latest', function( release ) {\n\t\t\n\t\tlet latest = release.name\n\t\t\n\t\tlog.info( `this version: ${version}` )\n\t\tlog.info( `latest version: ${latest}` )\n\t\t\n\t\tif( compareVersions.compare( version, latest, '<' ) ) {\n\t\t\t\n\t\t\t$('#update').attr('data-url', `https://www.midwinter-dg.com/mac-apps/nextcloud-notes-client.html?app`).fadeIn('slow')\n\t\t\t$('#update-version').html( latest )\n\t\t}\n\t})\n\t.done( function() {\n\t\t\n\t\tlog.info( `check release succeeded` )\n\t})\n\t.fail( function( jqXHR, textStatus, errorThrown ) {\n\t\t\n\t\tlog.error( `check release failed ${textStatus}` )\n\t})\n\t.always( function() {\n\t\t\n\t\tlog.info( `check release ended` )\n\t})\n}\n\n\n\n//note(dgmid): docready\n\n$(document).ready(function() {\n\t\n\t//note(dgmid): set lang\n\t\n\t$('html').attr('lang', i18n.language)\n\t\n\t\n\t//note(dgmid): display categories in sidebar \n\t\n\tif( store.get( 'appSettings.showcats' ) ) {\n\t\t\n\t\t$('#sidebar').addClass( 'showcats' )\n\t}\n\t\n\t\n\t//note(dgmid): toggle categories sidebar\n\t\n\tif( store.get( 'appInterface.categories' ) ) {\n\t\t\n\t\t$('#frame, footer').addClass( 'slide' )\n\t}\n\t\n\t//note(dgmid): set edit button title\n\t\n\t$('#edit').attr('title', i18n.t('app:main.button.edit', 'Edit Note'))\n\t\n\t\n\t//note(dgmid): set categories strings\n\t\n\t$('#cat-title').html( i18n.t('app:categories.title', 'Categories'))\n\t$('#cat-all').html( i18n.t('app:categories.all', 'All notes'))\n\t$('#cat-all').attr('title', i18n.t('app:categories.all', 'All notes'))\n\t$('#cat-fav').html( i18n.t('app:categories.fav', 'Favorites'))\n\t$('#cat-fav').attr('title', i18n.t('app:categories.fav', 'Favorites'))\n\t$('#cat-none').html( i18n.t('app:categories.none', 'Uncategorised'))\n\t$('#cat-none').attr('title', i18n.t('app:categories.none', 'Uncategorised'))\n\t$('#update-label').html( i18n.t('app:titlebar.update', 'Update Available'))\n\t\n\t\n\t//note(dgmid): check login\n\t\n\tif( !server || !username || !password ) {\n\t\t\n\t\topenModal( 'file://' + __dirname + '/../html/login.html', 480, 180, false )\n\t\t\n\t} else {\n\t\t\n\t\tapiCall('all')\n\t}\n\t\n\t\n\t//note(dgmid): edit save\n\t\n\t$('#edit').click(function() {\n\t\t\n\t\teditNote()\n\t})\n})\n"]}