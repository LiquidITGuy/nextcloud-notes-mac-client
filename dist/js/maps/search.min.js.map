{"version":3,"names":[],"mappings":"","sources":["search.js"],"sourcesContent":["'use strict'\n\nconst Store\t\t\t\t= require( 'electron-store' )\nconst JsSearch\t\t\t= require( 'js-search' )\nconst stemmer\t\t\t= require( 'stemmer' )\nconst sw\t\t\t\t= require( 'stopword' )\nconst removeMarkdown\t= require( 'remove-markdown' )\nconst $\t\t\t\t\t= require( 'jquery' )\nconst log\t\t\t\t= require( 'electron-log' )\n\nconst i18n\t\t\t\t= require( './i18n.min' )\nconst sanitize\t\t\t= require( './sanitize-category.min' )\n\nconst store\t\t\t\t= new Store()\nconst database\t\t\t= new Store({name: 'database'})\n\n\n\nmodule.exports.searchNotes = function( term, callback ) {\n\t\n\tlet termArr = term.split( ' ' ),\n\t\tdata\t= database.get( 'notes' ),\n\t\tcat \t= store.get('categories.selected'),\n\t\tlang\t= i18n.language.substring(0, 2),\n\t\tnotes\t= [],\n\t\tresult\t= [],\n\t\tclean\n\t\n\tif( store.get( 'appSettings.stopwords' ) ) {\n\t\t\n\t\tlet cleanArr \t= sw.removeStopwords( termArr, sw[checkStopwordLang( lang )] )\n\t\t\tclean \t\t= cleanArr.join( ' ' )\n\t\n\t} else {\n\t\n\t\tclean = term\n\t}\n\t\n\tfor( let item of data ) {\n\t\t\n\t\titem.content = removeMarkdown( item.content )\n\t\tlet catClass = sanitize.sanitizeCategory( item.category )\n\t\t\n\t\tnotes.push({\n\t\t\tid: item.id,\n\t\t\tcontent: item.content,\n\t\t\tcategory: catClass,\n\t\t\tfavorite: item.favorite\n\t\t})\n\t}\n\t\n\tlet search = new JsSearch.Search( 'id' )\n\t\n\tif( store.get( 'appSettings.stemming' ) ) {\n\t\n\t\tsearch.tokenizer = new JsSearch.StemmingTokenizer( stemmer, new JsSearch.SimpleTokenizer() )\n\t}\n\t\n\tsearch.addIndex( 'content' )\n\tsearch.addDocuments( notes )\n\tlet filtered = search.search( clean )\n\t\n\tfor( let item of filtered ) {\n\t\t\n\t\tresult.push( item.id )\n\t}\n\t\n\tcallback( result, clean )\n}\n\n\n\nfunction checkStopwordLang( theLang ) {\n\t\n\tconst langArr = ['af', 'ar', 'bn', 'br', 'da', 'de', 'es', 'fa', 'fi', 'fr', 'ha', 'he', 'hi', 'id', 'it', 'ja', 'nl', 'no', 'pl', 'pt', 'pa', 'ru', 'so', 'st', 'sv', 'sw', 'vi', 'yo', 'zh']\n\t\n\tif( langArr.includes( theLang ) ) {\n\t\t\n\t\treturn theLang\n\t\t\n\t} else {\n\t\t\n\t\treturn 'en'\n\t}\n}\n"],"file":"../search.min.js"}