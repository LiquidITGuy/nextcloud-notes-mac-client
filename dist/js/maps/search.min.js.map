{"version":3,"sources":["search.js"],"names":["Store","require","JsSearch","Snowball","sw","removeMarkdown","$","log","i18n","lang","language","substring","categories","store","database","name","module","exports","searchNotes","term","clean","termArr","split","data","get","notes","result","removeStopwords","checkStopwordLang","join","item","content","catClass","sanitizeCategory","category","push","id","favorite","search","Search","tokenizer","StemmingTokenizer","Stem","SimpleTokenizer","addIndex","addDocuments","filtered","searchResult","word","wordStemmer","checkStemmerLang","setCurrent","stem","getCurrent","theLang","includes","stemLang","hide","html","show"],"mappings":"AAAA,aAEA,MAAMA,MAAWC,QAAS,kBACpBC,SAAaD,QAAS,aACtBE,SAAaF,QAAS,YACtBG,GAAQH,QAAS,YACjBI,eAAiBJ,QAAS,mBAC1BK,EAAQL,QAAS,UACjBM,IAASN,QAAS,gBAElBO,KAAUP,QAAS,cACnBQ,KAAUD,KAAKE,SAASC,UAAU,EAAG,GACrCC,WAAcX,QAAS,oBAEvBY,MAAW,IAAIb,MACfc,SAAa,IAAId,MAAM,CAACe,KAAM,aAIpCC,OAAOC,QAAQC,YAAc,SAAUC,GAEtC,IAKCC,EALGC,EAAUF,EAAKG,MAAO,KACzBC,EAAOT,SAASU,IAAK,SAErBC,GADOZ,MAAMW,IAAI,uBACT,IACRE,EAAS,GAGV,IAA6C,IAAzCb,MAAMW,IAAK,yBAAqC,CAGlDJ,EADehB,GAAGuB,gBAAiBN,EAASjB,GAAGwB,kBAAmBnB,QAC/CoB,KAAM,UAI1BT,EAAQD,EAGT,IAAK,IAAIW,KAAQP,EAAO,CAEvBO,EAAKC,QAAU1B,eAAgByB,EAAKC,SACpC,IAAIC,EAAWpB,WAAWqB,iBAAkBH,EAAKI,UAEjDT,EAAMU,KAAK,CACVC,GAAIN,EAAKM,GACTL,QAASD,EAAKC,QACdG,SAAUF,EACVK,SAAUP,EAAKO,WAIjB,IAAIC,EAAS,IAAIpC,SAASqC,OAAQ,OAEU,IAAxC1B,MAAMW,IAAK,0BAEdc,EAAOE,UAAY,IAAItC,SAASuC,kBAAmB,IAAIC,KAAM,IAAIxC,SAASyC,kBAG3EL,EAAOM,SAAU,WACjBN,EAAOO,aAAcpB,GACrB,IAAIqB,EAAWR,EAAOA,OAAQlB,GAE9B,IAAK,IAAIU,KAAQgB,EAEhBpB,EAAOS,KAAML,EAAKM,IAGnBW,aAAcrB,EAAQN,IAKvB,IAAIsB,KAAO,SAAUM,GAEpB,IAAIC,EAAc,IAAI9C,SAAU+C,iBAAkBzC,OAElD,OAAO,SAAUuC,GAKhB,OAHAC,EAAYE,WAAYH,GACxBC,EAAYG,OAELH,EAAYI,eAMrB,SAASzB,kBAAmB0B,GAI3B,MAFgB,CAAC,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAE7KC,SAAUD,GAEdA,EAIA,KAMT,SAASJ,iBAAkBI,GAE1B,IAAIE,EAAW,UAEf,OAAQF,GAEP,IAAK,KACJE,EAAW,SACZ,MACA,IAAK,KACJA,EAAW,QACZ,MACA,IAAK,KACJA,EAAW,UACZ,MACA,IAAK,KACJA,EAAW,SACZ,MACA,IAAK,KACJA,EAAW,SACZ,MACA,IAAK,KACJA,EAAW,YACZ,MACA,IAAK,KACJA,EAAW,UACZ,MACA,IAAK,KACJA,EAAW,YACZ,MACA,IAAK,KACJA,EAAW,aACZ,MACA,IAAK,KACJA,EAAW,UACZ,MACA,IAAK,KACJA,EAAW,UACZ,MACA,IAAK,KACJA,EAAW,UACZ,MACA,IAAK,KACJA,EAAW,WACZ,MACA,IAAK,KACJA,EAAW,UAIb,OAAOA,EAKR,SAAST,aAAcrB,EAAQN,GAE9Bd,EAAE,eAAemD,OACjBnD,EAAE,WAAWoD,KAAMtC,GAAQuC,OAE3B,IAAK,IAAIvB,KAAMV,EAEdpB,EAAE,wBAAwB8B,OAAQuB","file":"../search.min.js","sourcesContent":["'use strict'\n\nconst Store\t\t\t\t= require( 'electron-store' )\nconst JsSearch\t\t\t= require( 'js-search' )\nconst Snowball\t\t\t= require( 'snowball' )\nconst sw\t\t\t\t= require( 'stopword' )\nconst removeMarkdown\t= require( 'remove-markdown' )\nconst $\t\t\t\t\t= require( 'jquery' )\nconst log\t\t\t\t= require( 'electron-log' )\n\nconst i18n\t\t\t\t= require( './i18n.min' )\nconst lang\t\t\t\t= i18n.language.substring(0, 2)\nconst categories\t\t= require( './categories.min' )\n\nconst store\t\t\t\t= new Store()\nconst database\t\t\t= new Store({name: 'database'})\n\n\n\nmodule.exports.searchNotes = function( term ) {\n\t\n\tlet termArr = term.split( ' ' ),\n\t\tdata\t= database.get( 'notes' ),\n\t\tcat \t= store.get('categories.selected'),\n\t\tnotes\t= [],\n\t\tresult\t= [],\n\t\tclean\n\t\n\tif( store.get( 'appSettings.stopwords' ) === true ) {\n\t\t\n\t\tlet cleanArr \t= sw.removeStopwords( termArr, sw[checkStopwordLang( lang )] )\n\t\t\tclean \t\t= cleanArr.join( ' ' )\n\t\n\t} else {\n\t\n\t\tclean = term\n\t}\n\t\n\tfor( let item of data ) {\n\t\t\n\t\titem.content = removeMarkdown( item.content )\n\t\tlet catClass = categories.sanitizeCategory( item.category )\n\t\t\n\t\tnotes.push({\n\t\t\tid: item.id,\n\t\t\tcontent: item.content,\n\t\t\tcategory: catClass,\n\t\t\tfavorite: item.favorite\n\t\t})\n\t}\n\t\n\tlet search = new JsSearch.Search( 'id' )\n\t\n\tif( store.get( 'appSettings.stemming' ) === true ) {\n\t\n\t\tsearch.tokenizer = new JsSearch.StemmingTokenizer( new Stem, new JsSearch.SimpleTokenizer() )\n\t}\n\t\n\tsearch.addIndex( 'content' )\n\tsearch.addDocuments( notes )\n\tlet filtered = search.search( clean )\n\t\n\tfor( let item of filtered ) {\n\t\t\n\t\tresult.push( item.id )\n\t}\n\t\n\tsearchResult( result, clean )\n}\n\n\n\nlet Stem = function( word ) {\n\t\n\tlet wordStemmer = new Snowball( checkStemmerLang( lang ) )\n\t\n\treturn function( word ) {\n\t\t\n\t\twordStemmer.setCurrent( word )\n\t\twordStemmer.stem()\n\t\t\n\t\treturn wordStemmer.getCurrent()\n\t}\n}\n\n\n\nfunction checkStopwordLang( theLang ) {\n\t\n\tconst langArr = ['af', 'ar', 'bn', 'br', 'da', 'de', 'es', 'fa', 'fi', 'fr', 'ha', 'he', 'hi', 'id', 'it', 'ja', 'nl', 'no', 'pl', 'pt', 'pa', 'ru', 'so', 'st', 'sv', 'sw', 'vi', 'yo', 'zh']\n\t\n\tif( langArr.includes( theLang ) ) {\n\t\t\n\t\treturn theLang\n\t\t\n\t} else {\n\t\t\n\t\treturn 'en'\n\t}\n}\n\n\n\nfunction checkStemmerLang( theLang ) {\n\t\n\tlet stemLang = 'english'\n\t\n\tswitch( theLang ) {\n\n\t\tcase 'da':\n\t\t\tstemLang = 'danish'\n\t\tbreak\n\t\tcase 'nl':\n\t\t\tstemLang = 'dutch'\n\t\tbreak\n\t\tcase 'fi':\n\t\t\tstemLang = 'finnish'\n\t\tbreak\n\t\tcase 'fr':\n\t\t\tstemLang = 'french'\n\t\tbreak\n\t\tcase 'de':\n\t\t\tstemLang = 'german'\n\t\tbreak\n\t\tcase 'hu':\n\t\t\tstemLang = 'hungarian'\n\t\tbreak\n\t\tcase 'it':\n\t\t\tstemLang = 'italian'\n\t\tbreak\n\t\tcase 'no':\n\t\t\tstemLang = 'norwegian'\n\t\tbreak\n\t\tcase 'pt':\n\t\t\tstemLang = 'portuguese'\n\t\tbreak\n\t\tcase 'ru':\n\t\t\tstemLang = 'russian'\n\t\tbreak\n\t\tcase 'es':\n\t\t\tstemLang = 'spanish'\n\t\tbreak\n\t\tcase 'sv':\n\t\t\tstemLang = 'swedish'\n\t\tbreak\n\t\tcase 'ro':\n\t\t\tstemLang = 'romanian'\n\t\tbreak\n\t\tcase 'tr':\n\t\t\tstemLang = 'turkish'\n\t\tbreak\n\t}\n\t\n\treturn stemLang\n}\n\n\n\nfunction searchResult( result, clean ) {\n\t\t\n\t$(`#sidebar li`).hide()\n\t$('#result').html( clean ).show()\n\t\n\tfor( let id of result ) {\n\t\t\n\t\t$(`#sidebar li[data-id='${id}']`).show()\t\n\t}\n}\n"]}